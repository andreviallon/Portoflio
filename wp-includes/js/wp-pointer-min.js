!function(t){var i=0,e=9999;t.widget("wp.pointer",{options:{pointerClass:"wp-pointer",pointerWidth:320,content:function(){return t(this).text()},buttons:function(i,e){var n=wpPointerL10n?wpPointerL10n.dismiss:"Dismiss",o;return t('<a class="close" href="#">'+n+"</a>").bind("click.pointer",function(t){t.preventDefault(),e.element.pointer("close")})},position:"top",show:function(t,i){i.pointer.show(),i.opened()},hide:function(t,i){i.pointer.hide(),i.closed()},document:document},_create:function(){var e,n;this.content=t('<div class="wp-pointer-content"></div>'),this.arrow=t('<div class="wp-pointer-arrow"><div class="wp-pointer-arrow-inner"></div></div>'),e="absolute",(n=this.element.parents().add(this.element)).filter(function(){return"fixed"===t(this).css("position")}).length&&(e="fixed"),this.pointer=t("<div />").append(this.content).append(this.arrow).attr("id","wp-pointer-"+i++).addClass(this.options.pointerClass).css({position:e,width:this.options.pointerWidth+"px",display:"none"}).appendTo(this.options.document.body)},_setOption:function(i,e){var n=this.options,o=this.pointer;"document"===i&&e!==n.document?o.detach().appendTo(e.body):"pointerClass"===i&&o.removeClass(n.pointerClass).addClass(e),t.Widget.prototype._setOption.apply(this,arguments),"position"===i?this.reposition():"content"===i&&this.active&&this.update()},destroy:function(){this.pointer.remove(),t.Widget.prototype.destroy.call(this)},widget:function(){return this.pointer},update:function(i){var e=this,n=this.options,o=t.Deferred(),s;if(!n.disabled)return o.done(function(t){e._update(i,t)}),(s="string"==typeof n.content?n.content:n.content.call(this.element[0],o.resolve,i,this._handoff()))&&o.resolve(s),o.promise()},_update:function(t,i){var e,n=this.options;i&&(this.pointer.stop(),this.content.html(i),(e=n.buttons.call(this.element[0],t,this._handoff()))&&e.wrap('<div class="wp-pointer-buttons" />').parent().appendTo(this.content),this.reposition())},reposition:function(){var i;this.options.disabled||(i=this._processPosition(this.options.position),this.pointer.css({top:0,left:0,zIndex:e++}).show().position(t.extend({of:this.element,collision:"fit none"},i)),this.repoint())},repoint:function(){var t=this.options,i;t.disabled||(i="string"==typeof t.position?t.position:t.position.edge,this.pointer[0].className=this.pointer[0].className.replace(/wp-pointer-[^\s'"]*/,""),this.pointer.addClass("wp-pointer-"+i))},_processPosition:function(i){var e={top:"bottom",bottom:"top",left:"right",right:"left"},n;return(n="string"==typeof i?{edge:i+""}:t.extend({},i)).edge?("top"==n.edge||"bottom"==n.edge?(n.align=n.align||"left",n.at=n.at||n.align+" "+e[n.edge],n.my=n.my||n.align+" "+n.edge):(n.align=n.align||"top",n.at=n.at||e[n.edge]+" "+n.align,n.my=n.my||n.edge+" "+n.align),n):n},open:function(t){var i=this,e=this.options;this.active||e.disabled||this.element.is(":hidden")||this.update().done(function(){i._open(t)})},_open:function(t){var i=this,e=this.options;this.active||e.disabled||this.element.is(":hidden")||(this.active=!0,this._trigger("open",t,this._handoff()),this._trigger("show",t,this._handoff({opened:function(){i._trigger("opened",t,i._handoff())}})))},close:function(t){if(this.active&&!this.options.disabled){var i=this;this.active=!1,this._trigger("close",t,this._handoff()),this._trigger("hide",t,this._handoff({closed:function(){i._trigger("closed",t,i._handoff())}}))}},sendToTop:function(){this.active&&this.pointer.css("z-index",e++)},toggle:function(t){this.pointer.is(":hidden")?this.open(t):this.close(t)},_handoff:function(i){return t.extend({pointer:this.pointer,element:this.element},i)}})}(jQuery);