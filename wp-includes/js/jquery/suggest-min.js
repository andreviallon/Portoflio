!function($){$.suggest=function(e,t){function l(){var t=p.offset();d.css({top:t.top+e.offsetHeight+"px",left:t.left+"px"})}function s(e){if(/27$|38$|40$/.test(e.keyCode)&&d.is(":visible")||/^13$|^9$/.test(e.keyCode)&&u())switch(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,e.keyCode){case 38:f();break;case 40:h();break;case 9:case 13:o();break;case 27:d.hide();break}else p.val().length!=C&&(m&&clearTimeout(m),m=setTimeout(a,t.delay),C=p.val().length)}function a(){var e=$.trim(p.val()),l,s;t.multiple&&-1!=(l=e.lastIndexOf(t.multipleSep))&&(e=$.trim(e.substr(l+t.multipleSep.length))),e.length>=t.minchars?(cached=n(e),cached?r(cached.items):$.get(t.source,{q:e},function(t){d.hide(),s=c(t,e),r(s),i(e,s,t.length)})):d.hide()}function n(e){var t;for(t=0;t<g.length;t++)if(g[t].q==e)return g.unshift(g.splice(t,1)[0]),g[0];return!1}function i(e,l,s){for(var a;g.length&&v+s>t.maxCacheSize;)a=g.pop(),v-=a.size;g.push({q:e,size:s,items:l}),v+=s}function r(e){var s="",a;if(e){if(!e.length)return void d.hide();for(l(),a=0;a<e.length;a++)s+="<li>"+e[a]+"</li>";d.html(s).show(),d.children("li").mouseover(function(){d.children("li").removeClass(t.selectClass),$(this).addClass(t.selectClass)}).click(function(e){e.preventDefault(),e.stopPropagation(),o()})}}function c(e,l){var s=[],a=e.split(t.delimiter),n,i;for(n=0;n<a.length;n++)(i=$.trim(a[n]))&&(i=i.replace(new RegExp(l,"ig"),function(e){return'<span class="'+t.matchClass+'">'+e+"</span>"}),s[s.length]=i);return s}function u(){var e;return!!d.is(":visible")&&(e=d.children("li."+t.selectClass),e.length||(e=!1),e)}function o(){$currentResult=u(),$currentResult&&(t.multiple?(-1!=p.val().indexOf(t.multipleSep)?$currentVal=p.val().substr(0,p.val().lastIndexOf(t.multipleSep)+t.multipleSep.length)+" ":$currentVal="",p.val($currentVal+$currentResult.text()+t.multipleSep+" "),p.focus()):p.val($currentResult.text()),d.hide(),p.trigger("change"),t.onSelect&&t.onSelect.apply(p[0]))}function h(){$currentResult=u(),$currentResult?$currentResult.removeClass(t.selectClass).next().addClass(t.selectClass):d.children("li:first-child").addClass(t.selectClass)}function f(){var e=u();e?e.removeClass(t.selectClass).prev().addClass(t.selectClass):d.children("li:last-child").addClass(t.selectClass)}var p,d,m,C,g,v;p=$(e).attr("autocomplete","off"),d=$("<ul/>"),m=!1,C=0,g=[],v=0,d.addClass(t.resultsClass).appendTo("body"),l(),$(window).on("load",l).on("resize",l),p.blur(function(){setTimeout(function(){d.hide()},200)}),p.keydown(s)},$.fn.suggest=function(e,t){if(e)return t=t||{},t.multiple=t.multiple||!1,t.multipleSep=t.multipleSep||",",t.source=e,t.delay=t.delay||100,t.resultsClass=t.resultsClass||"ac_results",t.selectClass=t.selectClass||"ac_over",t.matchClass=t.matchClass||"ac_match",t.minchars=t.minchars||2,t.delimiter=t.delimiter||"\n",t.onSelect=t.onSelect||!1,t.maxCacheSize=t.maxCacheSize||65536,this.each(function(){new $.suggest(this,t)}),this}}(jQuery);