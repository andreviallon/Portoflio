!function(e){function t(){return e("<div/>")}var o=Math.abs,i=Math.max,s=Math.min,n=Math.round;e.imgAreaSelect=function(r,c){function d(e){return e+Q.left-U.left}function a(e){return e+Q.top-U.top}function u(e){return e-Q.left+U.left}function l(e){return e-Q.top+U.top}function h(e){return i(e.pageX||0,m(e).x)-U.left}function f(e){return i(e.pageY||0,m(e).y)-U.top}function m(e){var t=e.originalEvent||{};return t.touches&&t.touches.length?{x:t.touches[0].pageX,y:t.touches[0].pageY}:{x:0,y:0}}function p(e){var t=e||te,o=e||oe;return{x1:n(me.x1*t),y1:n(me.y1*o),x2:n(me.x2*t),y2:n(me.y2*o),width:n(me.x2*t)-n(me.x1*t),height:n(me.y2*o)-n(me.y1*o)}}function y(e,t,o,i,s){var r=s||te,c=s||oe;(me={x1:n(e/r||0),y1:n(t/c||0),x2:n(o/r||0),y2:n(i/c||0)}).width=me.x2-me.x1,me.height=me.y2-me.y1}function g(){L&&T.width()&&(Q={left:n(T.offset().left),top:n(T.offset().top)},F=T.innerWidth(),G=T.innerHeight(),Q.top+=T.outerHeight()-G>>1,Q.left+=T.outerWidth()-F>>1,se=n(c.minWidth/te)||0,ne=n(c.minHeight/oe)||0,re=n(s(c.maxWidth/te||1<<24,F)),ce=n(s(c.maxHeight/oe||1<<24,G)),"1.3.2"!=e().jquery||"fixed"!=Z||pe.getBoundingClientRect||(Q.top+=i(document.body.scrollTop,pe.scrollTop),Q.left+=i(document.body.scrollLeft,pe.scrollLeft)),U=/absolute|relative/.test(J.css("position"))?{left:n(J.offset().left)-J.scrollLeft(),top:n(J.offset().top)-J.scrollTop()}:"fixed"==Z?{left:e(document).scrollLeft(),top:e(document).scrollTop()}:{left:0,top:0},q=d(0),B=a(0),(me.x2>F||me.y2>G)&&C())}function v(t){if(ae){switch(j.css({left:d(me.x1),top:a(me.y1)}).add(D).width(we=me.width).height(Se=me.height),D.add(R).add(Y).css({left:0,top:0}),R.width(i(we-R.outerWidth()+R.innerWidth(),0)).height(i(Se-R.outerHeight()+R.innerHeight(),0)),e(X[0]).css({left:q,top:B,width:me.x1,height:G}),e(X[1]).css({left:q+me.x1,top:B,width:we,height:me.y1}),e(X[2]).css({left:q+me.x2,top:B,width:F-me.x2,height:G}),e(X[3]).css({left:q+me.x1,top:B+me.y2,width:we,height:G-me.y2}),we-=Y.outerWidth(),Se-=Y.outerHeight(),Y.length){case 8:e(Y[4]).css({left:we>>1}),e(Y[5]).css({left:we,top:Se>>1}),e(Y[6]).css({left:we>>1,top:Se}),e(Y[7]).css({top:Se>>1});case 4:Y.slice(1,3).css({left:we}),Y.slice(2,4).css({top:Se})}!1!==t&&(e.imgAreaSelect.onKeyPress!=ke&&e(document).unbind(e.imgAreaSelect.keyPress,e.imgAreaSelect.onKeyPress),c.keys&&e(document)[e.imgAreaSelect.keyPress](e.imgAreaSelect.onKeyPress=ke)),Ce&&R.outerWidth()-R.innerWidth()==2&&(R.css("margin",0),setTimeout(function(){R.css("margin","auto")},0))}}function b(e){g(),v(e),ue=d(me.x1),le=a(me.y1),he=d(me.x2),fe=a(me.y2)}function x(e,t){c.fadeSpeed?e.fadeOut(c.fadeSpeed,t):e.hide()}function w(e){var t=u(h(e))-me.x1,o=l(f(e))-me.y1;ze||(g(),ze=!0,j.one("mouseout",function(){ze=!1})),ie="",c.resizable&&(o<=c.resizeMargin?ie="n":o>=me.height-c.resizeMargin&&(ie="s"),t<=c.resizeMargin?ie+="w":t>=me.width-c.resizeMargin&&(ie+="e")),j.css("cursor",ie?ie+"-resize":c.movable?"move":""),$&&$.toggle()}function S(t){e("body").css("cursor",""),(c.autoHide||me.width*me.height==0)&&x(j.add(X),function(){e(this).hide()}),e(document).off("mousemove touchmove",A),j.on("mousemove touchmove",w),c.onSelectEnd(r,p())}function z(t){return("mousedown"!=t.type||1==t.which)&&(w(t),g(),ie?(e("body").css("cursor",ie+"-resize"),ue=d(me[/w/.test(ie)?"x2":"x1"]),le=a(me[/n/.test(ie)?"y2":"y1"]),e(document).on("mousemove touchmove",A).one("mouseup touchend",S),j.off("mousemove touchmove",w)):c.movable?(_=q+me.x1-h(t),ee=B+me.y1-f(t),j.off("mousemove touchmove",w),e(document).on("mousemove touchmove",I).one("mouseup touchend",function(){c.onSelectEnd(r,p()),e(document).off("mousemove touchmove",I),j.on("mousemove touchmove",w)})):T.mousedown(t),!1)}function k(e){de&&(e?(he=i(q,s(q+F,ue+o(fe-le)*de*(he>ue||-1))),fe=n(i(B,s(B+G,le+o(he-ue)/de*(fe>le||-1)))),he=n(he)):(fe=i(B,s(B+G,le+o(he-ue)/de*(fe>le||-1))),he=n(i(q,s(q+F,ue+o(fe-le)*de*(he>ue||-1)))),fe=n(fe)))}function C(){ue=s(ue,q+F),le=s(le,B+G),o(he-ue)<se&&((he=ue-se*(he<ue||-1))<q?ue=q+se:he>q+F&&(ue=q+F-se)),o(fe-le)<ne&&((fe=le-ne*(fe<le||-1))<B?le=B+ne:fe>B+G&&(le=B+G-ne)),he=i(q,s(he,q+F)),fe=i(B,s(fe,B+G)),k(o(he-ue)<o(fe-le)*de),o(he-ue)>re&&(he=ue-re*(he<ue||-1),k()),o(fe-le)>ce&&(fe=le-ce*(fe<le||-1),k(!0)),me={x1:u(s(ue,he)),x2:u(i(ue,he)),y1:l(s(le,fe)),y2:l(i(le,fe)),width:o(he-ue),height:o(fe-le)},v(),c.onSelectChange(r,p())}function A(e){return he=/w|e|^$/.test(ie)||de?h(e):d(me.x2),fe=/n|s|^$/.test(ie)||de?f(e):a(me.y2),C(),!1}function W(t,o){he=(ue=t)+me.width,fe=(le=o)+me.height,e.extend(me,{x1:u(ue),y1:l(le),x2:u(he),y2:l(fe)}),v(),c.onSelectChange(r,p())}function I(e){return ue=i(q,s(_+h(e),q+F-me.width)),le=i(B,s(ee+f(e),B+G-me.height)),W(ue,le),e.preventDefault(),!1}function K(){e(document).off("mousemove touchmove",K),g(),he=ue,fe=le,C(),ie="",X.is(":visible")||j.add(X).hide().fadeIn(c.fadeSpeed||0),ae=!0,e(document).off("mouseup touchend",P).on("mousemove touchmove",A).one("mouseup touchend",S),j.off("mousemove touchmove",w),c.onSelectStart(r,p())}function P(){e(document).off("mousemove touchmove",K).off("mouseup touchend",P),x(j.add(X)),y(u(ue),l(le),u(ue),l(le)),this instanceof e.imgAreaSelect||(c.onSelectChange(r,p()),c.onSelectEnd(r,p()))}function N(t){return!(t.which>1||X.is(":animated"))&&(g(),_=ue=h(t),ee=le=f(t),e(document).on({"mousemove touchmove":K,"mouseup touchend":P}),!1)}function H(){b(!1)}function M(){L=!0,O(c=e.extend({classPrefix:"imgareaselect",movable:!0,parent:"body",resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},c)),j.add(X).css({visibility:""}),c.show&&(ae=!0,g(),v(),j.add(X).hide().fadeIn(c.fadeSpeed||0)),setTimeout(function(){c.onInit(r,p())},0)}function E(e,t){for(var o in t)void 0!==c[o]&&e.css(t[o],c[o])}function O(o){if(o.parent&&(J=e(o.parent)).append(j.add(X)),e.extend(c,o),g(),null!=o.handles){for(Y.remove(),Y=e([]),be=o.handles?"corners"==o.handles?4:8:0;be--;)Y=Y.add(t());Y.addClass(c.classPrefix+"-handle").css({position:"absolute",fontSize:0,zIndex:V+1||1}),!parseInt(Y.css("width"))>=0&&Y.width(5).height(5),(xe=c.borderWidth)&&Y.css({borderWidth:xe,borderStyle:"solid"}),E(Y,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}for(te=c.imageWidth/F||1,oe=c.imageHeight/G||1,null!=o.x1&&(y(o.x1,o.y1,o.x2,o.y2),o.show=!o.hide),o.keys&&(c.keys=e.extend({shift:1,ctrl:"resize"},o.keys)),X.addClass(c.classPrefix+"-outer"),D.addClass(c.classPrefix+"-selection"),be=0;be++<4;)e(R[be-1]).addClass(c.classPrefix+"-border"+be);E(D,{selectionColor:"background-color",selectionOpacity:"opacity"}),E(R,{borderOpacity:"opacity",borderWidth:"border-width"}),E(X,{outerColor:"background-color",outerOpacity:"opacity"}),(xe=c.borderColor1)&&e(R[0]).css({borderStyle:"solid",borderColor:xe}),(xe=c.borderColor2)&&e(R[1]).css({borderStyle:"dashed",borderColor:xe}),j.append(D.add(R).add($)).append(Y),Ce&&((xe=(X.css("filter")||"").match(/opacity=(\d+)/))&&X.css("opacity",xe[1]/100),(xe=(R.css("filter")||"").match(/opacity=(\d+)/))&&R.css("opacity",xe[1]/100)),o.hide?x(j.add(X)):o.show&&L&&(ae=!0,j.add(X).fadeIn(c.fadeSpeed||0),b()),de=(ve=(c.aspectRatio||"").split(/:/))[0]/ve[1],T.add(X).unbind("mousedown",N),c.disable||!1===c.enable?(j.off({"mousemove touchmove":w,"mousedown touchstart":z}),e(window).off("resize",H)):((c.enable||!1===c.disable)&&((c.resizable||c.movable)&&j.on({"mousemove touchmove":w,"mousedown touchstart":z}),e(window).resize(H)),c.persistent||T.add(X).on("mousedown touchstart",N)),c.enable=c.disable=void 0}var T=e(r),L,j=t(),D=t(),R=t().add(t()).add(t()).add(t()),X=t().add(t()).add(t()).add(t()),Y=e([]),$,q,B,Q={left:0,top:0},F,G,J,U={left:0,top:0},V=0,Z="absolute",_,ee,te,oe,ie,se,ne,re,ce,de,ae,ue,le,he,fe,me={x1:0,y1:0,x2:0,y2:0,width:0,height:0},pe=document.documentElement,ye=navigator.userAgent,ge,ve,be,xe,we,Se,ze,ke=function(e){var t=c.keys,o,n,r=e.keyCode;if(o=isNaN(t.alt)||!e.altKey&&!e.originalEvent.altKey?!isNaN(t.ctrl)&&e.ctrlKey?t.ctrl:!isNaN(t.shift)&&e.shiftKey?t.shift:isNaN(t.arrows)?10:t.arrows:t.alt,"resize"==t.arrows||"resize"==t.shift&&e.shiftKey||"resize"==t.ctrl&&e.ctrlKey||"resize"==t.alt&&(e.altKey||e.originalEvent.altKey)){switch(r){case 37:o=-o;case 39:n=i(ue,he),ue=s(ue,he),he=i(n+o,ue),k();break;case 38:o=-o;case 40:n=i(le,fe),le=s(le,fe),fe=i(n+o,le),k(!0);break;default:return}C()}else switch(ue=s(ue,he),le=s(le,fe),r){case 37:W(i(ue-o,q),le);break;case 38:W(ue,i(le-o,B));break;case 39:W(ue+s(o,F-u(he)),le);break;case 40:W(ue,le+s(o,G-l(fe)));break;default:return}return!1};this.remove=function(){O({disable:!0}),j.add(X).remove()},this.getOptions=function(){return c},this.setOptions=O,this.getSelection=p,this.setSelection=y,this.cancelSelection=P,this.update=b;var Ce=(/msie ([\w.]+)/i.exec(ye)||[])[1],Ae=/opera/i.test(ye),We=/webkit/i.test(ye)&&!/chrome/i.test(ye);for(ge=T;ge.length;)V=i(V,isNaN(ge.css("z-index"))?V:ge.css("z-index")),"fixed"==ge.css("position")&&(Z="fixed"),ge=ge.parent(":not(body)");V=c.zIndex||V,Ce&&T.attr("unselectable","on"),e.imgAreaSelect.keyPress=Ce||We?"keydown":"keypress",Ae&&($=t().css({width:"100%",height:"100%",position:"absolute",zIndex:V+2||2})),j.add(X).css({visibility:"hidden",position:Z,overflow:"hidden",zIndex:V||"0"}),j.css({zIndex:V+2||2}),D.add(R).css({position:"absolute",fontSize:0}),r.complete||"complete"==r.readyState||!T.is("img")?M():T.one("load",M),!L&&Ce&&Ce>=7&&(r.src=r.src)},e.fn.imgAreaSelect=function(t){return t=t||{},this.each(function(){e(this).data("imgAreaSelect")?t.remove?(e(this).data("imgAreaSelect").remove(),e(this).removeData("imgAreaSelect")):e(this).data("imgAreaSelect").setOptions(t):t.remove||(void 0===t.enable&&void 0===t.disable&&(t.enable=!0),e(this).data("imgAreaSelect",new e.imgAreaSelect(this,t)))}),t.instance?e(this).data("imgAreaSelect"):this}}(jQuery);