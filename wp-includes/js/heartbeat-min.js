!function($,e,n){var t=function(){function t(){var n,t,r,o;"string"==typeof e.pagenow&&(T.screenId=e.pagenow),"string"==typeof e.ajaxurl&&(T.url=e.ajaxurl),"object"==typeof e.heartbeatSettings&&(n=e.heartbeatSettings,!T.url&&n.ajaxurl&&(T.url=n.ajaxurl),n.interval&&(T.mainInterval=n.interval,T.mainInterval<15?T.mainInterval=15:T.mainInterval>120&&(T.mainInterval=120)),n.minimalInterval&&(n.minimalInterval=parseInt(n.minimalInterval,10),T.minimalInterval=n.minimalInterval>0&&n.minimalInterval<=600?1e3*n.minimalInterval:0),T.minimalInterval&&T.mainInterval<T.minimalInterval&&(T.mainInterval=T.minimalInterval),T.screenId||(T.screenId=n.screenId||"front"),"disable"===n.suspension&&(T.suspendEnabled=!1)),T.mainInterval=1e3*T.mainInterval,T.originalInterval=T.mainInterval,void 0!==document.hidden?(t="hidden",o="visibilitychange",r="visibilityState"):void 0!==document.msHidden?(t="msHidden",o="msvisibilitychange",r="msVisibilityState"):void 0!==document.webkitHidden&&(t="webkitHidden",o="webkitvisibilitychange",r="webkitVisibilityState"),t&&(document[t]&&(T.hasFocus=!1),F.on(o+".wp-heartbeat",function(){"hidden"===document[r]?(l(),e.clearInterval(T.checkFocusTimer)):(v(),document.hasFocus&&(T.checkFocusTimer=e.setInterval(i,1e4)))})),document.hasFocus&&(T.checkFocusTimer=e.setInterval(i,1e4)),$(e).on("unload.wp-heartbeat",function(){T.suspend=!0,T.xhr&&4!==T.xhr.readyState&&T.xhr.abort()}),e.setInterval(d,3e4),F.ready(function(){T.lastTick=a(),s()})}function a(){return(new Date).getTime()}function r(n){var t,a=n.src;if(a&&/^https?:\/\//.test(a)&&(t=e.location.origin?e.location.origin:e.location.protocol+"//"+e.location.host,0!==a.indexOf(t)))return!1;try{if(n.contentWindow.document)return!0}catch(e){}return!1}function i(){T.hasFocus&&!document.hasFocus()?l():!T.hasFocus&&document.hasFocus()&&v()}function o(e,n){var t;if(e){switch(e){case"abort":break;case"timeout":t=!0;break;case"error":if(503===n&&T.hasConnected){t=!0;break}case"parsererror":case"empty":case"unknown":T.errorcount++,T.errorcount>2&&T.hasConnected&&(t=!0);break}t&&!I()&&(T.connectionError=!0,F.trigger("heartbeat-connection-lost",[e,n]))}}function c(){T.hasConnected=!0,I()&&(T.errorcount=0,T.connectionError=!1,F.trigger("heartbeat-connection-restored"))}function u(){var n,t;T.connecting||T.suspend||(T.lastTick=a(),t=$.extend({},T.queue),T.queue={},F.trigger("heartbeat-send",[t]),n={data:t,interval:T.tempInterval?T.tempInterval/1e3:T.mainInterval/1e3,_nonce:"object"==typeof e.heartbeatSettings?e.heartbeatSettings.nonce:"",action:"heartbeat",screen_id:T.screenId,has_focus:T.hasFocus},"customize"===T.screenId&&(n.wp_customize="on"),T.connecting=!0,T.xhr=$.ajax({url:T.url,type:"post",timeout:3e4,data:n,dataType:"json"}).always(function(){T.connecting=!1,s()}).done(function(e,n,t){var a;if(!e)return void o("empty");c(),e.nonces_expired&&F.trigger("heartbeat-nonces-expired"),e.heartbeat_interval&&(a=e.heartbeat_interval,delete e.heartbeat_interval),F.trigger("heartbeat-tick",[e,n,t]),a&&b(a)}).fail(function(e,n,t){o(n||"unknown",e.status),F.trigger("heartbeat-error",[e,n,t])}))}function s(){var n=a()-T.lastTick,t=T.mainInterval;T.suspend||(T.hasFocus?T.countdown>0&&T.tempInterval&&(t=T.tempInterval,--T.countdown<1&&(T.tempInterval=0)):t=12e4,T.minimalInterval&&t<T.minimalInterval&&(t=T.minimalInterval),e.clearTimeout(T.beatTimer),n<t?T.beatTimer=e.setTimeout(function(){u()},t-n):u())}function l(){T.hasFocus=!1}function v(){T.userActivity=a(),T.suspend=!1,T.hasFocus||(T.hasFocus=!0,s())}function m(){T.userActivityEvents=!1,F.off(".wp-heartbeat-active"),$("iframe").each(function(e,n){r(n)&&$(n.contentWindow).off(".wp-heartbeat-active")}),v()}function d(){var e=T.userActivity?a()-T.userActivity:0;e>3e5&&T.hasFocus&&l(),(T.suspendEnabled&&e>6e5||e>36e5)&&(T.suspend=!0),T.userActivityEvents||(F.on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active touchend.wp-heartbeat-active",function(){m()}),$("iframe").each(function(e,n){r(n)&&$(n.contentWindow).on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active touchend.wp-heartbeat-active",function(){m()})}),T.userActivityEvents=!0)}function h(){return T.hasFocus}function I(){return T.connectionError}function p(){T.lastTick=0,s()}function f(){T.suspendEnabled=!1}function b(e,n){var t,a=T.tempInterval?T.tempInterval:T.mainInterval;if(e){switch(e){case"fast":case 5:t=5e3;break;case 15:t=15e3;break;case 30:t=3e4;break;case 60:t=6e4;break;case 120:t=12e4;break;case"long-polling":return T.mainInterval=0,0;default:t=T.originalInterval}T.minimalInterval&&t<T.minimalInterval&&(t=T.minimalInterval),5e3===t?(n=parseInt(n,10)||30,n=n<1||n>30?30:n,T.countdown=n,T.tempInterval=t):(T.countdown=0,T.tempInterval=0,T.mainInterval=t),t!==a&&s()}return T.tempInterval?T.tempInterval/1e3:T.mainInterval/1e3}function w(e,n,t){return!!e&&((!t||!this.isQueued(e))&&(T.queue[e]=n,!0))}function g(e){if(e)return T.queue.hasOwnProperty(e)}function y(e){e&&delete T.queue[e]}function k(e){if(e)return this.isQueued(e)?T.queue[e]:n}var F=$(document),T={suspend:!1,suspendEnabled:!0,screenId:"",url:"",lastTick:0,queue:{},mainInterval:60,tempInterval:0,originalInterval:0,minimalInterval:0,countdown:0,connecting:!1,connectionError:!1,errorcount:0,hasConnected:!1,hasFocus:!0,userActivity:0,userActivityEvents:!1,checkFocusTimer:0,beatTimer:0};return t(),{hasFocus:h,connectNow:p,disableSuspend:f,interval:b,hasConnectionError:I,enqueue:w,dequeue:y,isQueued:g,getQueuedItem:k}};e.wp=e.wp||{},e.wp.heartbeat=new t}(jQuery,window);