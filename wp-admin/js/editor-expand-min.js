!function(t,$,e){"use strict";var o=$(t),i=$(document),n=$("#wpadminbar"),s=$("#wpfooter");$(function(){function e(){var t=v.value.length;E&&!E.isHidden()||(E||"tinymce"!==L)&&(t<x?N():parseInt(v.style.height,10)<v.scrollHeight&&(v.style.height=Math.ceil(v.scrollHeight)+"px",a()),x=t)}function f(){var t=o.width();V={windowHeight:o.height(),windowWidth:t,adminBarHeight:t>600?n.outerHeight():0,toolsHeight:h.outerHeight()||0,menuBarHeight:T.outerHeight()||0,visualTopHeight:m.outerHeight()||0,textTopHeight:H.outerHeight()||0,bottomHeight:y.outerHeight()||0,statusBarHeight:B.outerHeight()||0,sideSortablesHeight:C.height()||0},V.menuBarHeight<3&&(V.menuBarHeight=0)}function a(n){if(!z||!z.settings.visible){var a=o.scrollTop(),d=n&&n.type,c="scroll"!==d,u=E&&!E.isHidden(),r=I,l=O.offset().top,p=1,v=g.width(),x,_,k,A,U,P,L,N,j;!c&&V.windowHeight||f(),u||"resize"!==d||e(),u?(x=m,_=w,L=V.visualTopHeight):(x=H,_=b,L=V.textTopHeight),(u||x.length)&&(P=x.parent().offset().top,N=_.offset().top,j=_.outerHeight(),U=u?I+L:I+20,U=j>U+5,U?((!W||c)&&a>=P-V.toolsHeight-V.adminBarHeight&&a<=P-V.toolsHeight-V.adminBarHeight+j-r?(W=!0,h.css({position:"fixed",top:V.adminBarHeight,width:v}),u&&T.length&&T.css({position:"fixed",top:V.adminBarHeight+V.toolsHeight,width:v-2-(u?0:x.outerWidth()-x.width())}),x.css({position:"fixed",top:V.adminBarHeight+V.toolsHeight+V.menuBarHeight,width:v-2-(u?0:x.outerWidth()-x.width())})):(W||c)&&(a<=P-V.toolsHeight-V.adminBarHeight?(W=!1,h.css({position:"absolute",top:0,width:v}),u&&T.length&&T.css({position:"absolute",top:0,width:v-2}),x.css({position:"absolute",top:V.menuBarHeight,width:v-2-(u?0:x.outerWidth()-x.width())})):a>=P-V.toolsHeight-V.adminBarHeight+j-r&&(W=!1,h.css({position:"absolute",top:j-r,width:v}),u&&T.length&&T.css({position:"absolute",top:j-r,width:v-2}),x.css({position:"absolute",top:j-r+V.menuBarHeight,width:v-2-(u?0:x.outerWidth()-x.width())}))),(!K||c&&M)&&a+V.windowHeight<=N+j+V.bottomHeight+V.statusBarHeight+1?n&&n.deltaHeight>0&&n.deltaHeight<100?t.scrollBy(0,n.deltaHeight):u&&M&&(K=!0,B.css({position:"fixed",bottom:V.bottomHeight,visibility:"",width:v-2}),y.css({position:"fixed",bottom:0,width:v})):(!M&&K||(K||c)&&a+V.windowHeight>N+j+V.bottomHeight+V.statusBarHeight-1)&&(K=!1,B.attr("style",M?"":"visibility: hidden;"),y.attr("style",""))):c&&(h.css({position:"absolute",top:0,width:v}),u&&T.length&&T.css({position:"absolute",top:0,width:v-2}),x.css({position:"absolute",top:V.menuBarHeight,width:v-2-(u?0:x.outerWidth()-x.width())}),B.attr("style",M?"":"visibility: hidden;"),y.attr("style","")),S.width()<300&&V.windowWidth>600&&i.height()>C.height()+l+120&&V.windowHeight<j?(V.sideSortablesHeight+X+F>V.windowHeight||R||Y?a+X<=l?(C.attr("style",""),R=Y=!1):a>D?R?(R=!1,k=C.offset().top-V.adminBarHeight,A=s.offset().top,A<k+V.sideSortablesHeight+F&&(k=A-V.sideSortablesHeight-12),C.css({position:"absolute",top:k,bottom:""})):!Y&&V.sideSortablesHeight+C.offset().top+F<a+V.windowHeight&&(Y=!0,C.css({position:"fixed",top:"auto",bottom:F})):a<D&&(Y?(Y=!1,k=C.offset().top-F,A=s.offset().top,A<k+V.sideSortablesHeight+F&&(k=A-V.sideSortablesHeight-12),C.css({position:"absolute",top:k,bottom:""})):!R&&C.offset().top>=a+X&&(R=!0,C.css({position:"fixed",top:X,bottom:""}))):(a>=l-X?C.css({position:"fixed",top:X}):C.attr("style",""),R=Y=!1),D=a):(C.attr("style",""),R=Y=!1),c&&(g.css({paddingTop:V.toolsHeight}),u?w.css({paddingTop:V.visualTopHeight+V.menuBarHeight}):b.css({marginTop:V.textTopHeight})))}}function d(){e(),a()}function c(t){for(var e=1;e<6;e++)setTimeout(t,500*e)}function u(){clearTimeout(U),U=setTimeout(a,100)}function r(){t.pageYOffset&&t.pageYOffset>P&&t.scrollTo(t.pageXOffset,0),p.addClass("wp-editor-expand"),o.on("scroll.editor-expand resize.editor-expand",function(t){a(t.type),u()}),i.on("wp-collapse-menu.editor-expand postboxes-columnchange.editor-expand editor-classchange.editor-expand",a).on("postbox-toggled.editor-expand postbox-moved.editor-expand",function(){!R&&!Y&&t.pageYOffset>X&&(Y=!0,t.scrollBy(0,-1),a(),t.scrollBy(0,1)),a()}).on("wp-window-resized.editor-expand",function(){E&&!E.isHidden()?E.execCommand("wpAutoResize"):e()}),b.on("focus.editor-expand input.editor-expand propertychange.editor-expand",e),k(),z&&z.pubsub.subscribe("hidden",d),E&&(E.settings.wp_autoresize_on=!0,E.execCommand("wpAutoResizeOn"),E.isHidden()||E.execCommand("wpAutoResize")),E&&!E.isHidden()||e(),a(),i.trigger("editor-expand-on")}function l(){var e=parseInt(t.getUserSetting("ed_size",300),10);e<50?e=50:e>5e3&&(e=5e3),t.pageYOffset&&t.pageYOffset>P&&t.scrollTo(t.pageXOffset,0),p.removeClass("wp-editor-expand"),o.off(".editor-expand"),i.off(".editor-expand"),b.off(".editor-expand"),A(),z&&z.pubsub.unsubscribe("hidden",d),$.each([m,H,h,T,y,B,g,w,b,C],function(t,e){e&&e.attr("style","")}),W=K=R=Y=!1,E&&(E.settings.wp_autoresize_on=!1,E.execCommand("wpAutoResizeOff"),E.isHidden()||(b.hide(),e&&E.theme.resizeTo(null,e))),e&&b.height(e),i.trigger("editor-expand-off")}var p=$("#postdivrich"),g=$("#wp-content-wrap"),h=$("#wp-content-editor-tools"),m=$(),w=$(),H=$("#ed_toolbar"),b=$("#content"),v=b[0],x=0,y=$("#post-status-info"),T=$(),B=$(),C=$("#side-sortables"),S=$("#postbox-container-1"),O=$("#post-body"),z=t.wp.editor&&t.wp.editor.fullscreen,E,k=function(){},A=function(){},W=!1,K=!1,R=!1,Y=!1,U,D=0,P=130,X=56,F=20,I=300,L=g.hasClass("tmce-active")?"tinymce":"html",M=!!parseInt(t.getUserSetting("hidetb"),10),V={windowHeight:0,windowWidth:0,adminBarHeight:0,toolsHeight:0,menuBarHeight:0,visualTopHeight:0,textTopHeight:0,bottomHeight:0,statusBarHeight:0,sideSortablesHeight:0},N=t._.throttle(function(){var e=t.scrollX||document.documentElement.scrollLeft,o=t.scrollY||document.documentElement.scrollTop,i=parseInt(v.style.height,10);v.style.height=I+"px",v.scrollHeight>I&&(v.style.height=v.scrollHeight+"px"),void 0!==e&&t.scrollTo(e,o),v.scrollHeight<i&&a()},300);i.on("tinymce-editor-init.editor-expand",function(i,n){function s(){var t=n.selection.getNode(),e,o,i;if(n.wp&&n.wp.getView&&(o=n.wp.getView(t)))i=o.getBoundingClientRect();else{e=n.selection.getRng();try{i=e.getClientRects()[0]}catch(t){}i||(i=t.getBoundingClientRect())}return!!i.height&&i}function f(t){var e=t.keyCode;e<=47&&e!==H.SPACEBAR&&e!==H.ENTER&&e!==H.DELETE&&e!==H.BACKSPACE&&e!==H.UP&&e!==H.LEFT&&e!==H.DOWN&&e!==H.UP||e>=91&&e<=93||e>=112&&e<=123||144===e||145===e||d(e)}function d(e){var o=s(),i=50,f,a,d,c;o&&(f=o.top+n.iframeElement.getBoundingClientRect().top,a=f+o.height,f-=50,a+=50,d=V.adminBarHeight+V.toolsHeight+V.menuBarHeight+V.visualTopHeight,(c=V.windowHeight-(M?V.bottomHeight+V.statusBarHeight:0))-d<o.height||(f<d&&(e===H.UP||e===H.LEFT||e===H.BACKSPACE)?t.scrollTo(t.pageXOffset,f+t.pageYOffset-d):a>c&&t.scrollTo(t.pageXOffset,a+t.pageYOffset-c)))}function u(t){t.state||a()}function r(){o.on("scroll.mce-float-panels",b),setTimeout(function(){n.execCommand("wpAutoResize"),a()},300)}function l(){o.off("scroll.mce-float-panels"),setTimeout(function(){var o=g.offset().top;t.pageYOffset>o&&t.scrollTo(t.pageXOffset,o-V.adminBarHeight),e(),a()},100),a()}function h(){M=!M}var H=t.tinymce.util.VK,b=_.debounce(function(){!$(".mce-floatpanel:hover").length&&t.tinymce.ui.FloatPanel.hideAll(),$(".mce-tooltip").hide()},1e3,!0);"content"===n.id&&(E=n,n.settings.autoresize_min_height=I,m=g.find(".mce-toolbar-grp"),w=g.find(".mce-edit-area"),B=g.find(".mce-statusbar"),T=g.find(".mce-menubar"),k=function(){n.on("keyup",f),n.on("show",r),n.on("hide",l),n.on("wp-toolbar-toggle",h),n.on("setcontent wp-autoresize wp-toolbar-toggle",a),n.on("undo redo",d),n.on("FullscreenStateChanged",u),o.off("scroll.mce-float-panels").on("scroll.mce-float-panels",b)},A=function(){n.off("keyup",f),n.off("show",r),n.off("hide",l),n.off("wp-toolbar-toggle",h),n.off("setcontent wp-autoresize wp-toolbar-toggle",a),n.off("undo redo",d),n.off("FullscreenStateChanged",u),o.off("scroll.mce-float-panels")},p.hasClass("wp-editor-expand")&&(k(),c(a)))}),p.hasClass("wp-editor-expand")&&(r(),g.hasClass("html-active")&&c(function(){a(),e()})),$("#adv-settings .editor-expand").show(),$("#editor-expand-toggle").on("change.editor-expand",function(){$(this).prop("checked")?(r(),t.setUserSetting("editor_expand","on")):(l(),t.setUserSetting("editor_expand","off"))}),t.editorExpand={on:r,off:l}}),$(function(){function e(){X=T.offset(),X.right=X.left+T.outerWidth(),X.bottom=X.top+T.outerHeight()}function f(){A||(A=!0,i.trigger("dfw-activate"),C.on("keydown.focus-shortcut",v))}function a(){A&&(u(),A=!1,i.trigger("dfw-deactivate"),C.off("keydown.focus-shortcut"))}function d(){return A}function c(){!W&&A&&(W=!0,C.on("keydown.focus",p),B.add(C).on("blur.focus",h),p(),t.setUserSetting("post_dfw","on"),i.trigger("dfw-on"))}function u(){W&&(W=!1,B.add(C).off(".focus"),g(),T.off(".focus"),t.setUserSetting("post_dfw","off"),i.trigger("dfw-off"))}function r(){W?u():c()}function l(){return W}function p(i){var n,s=i&&i.keyCode;if(t.navigator.platform&&(n=t.navigator.platform.indexOf("Mac")>-1),27===s||87===s&&i.altKey&&(!n&&i.shiftKey||n&&i.ctrlKey))return void g(i);i&&(i.metaKey||i.ctrlKey&&!i.altKey||i.altKey&&i.shiftKey||s&&(s<=47&&8!==s&&13!==s&&32!==s&&46!==s||s>=91&&s<=93||s>=112&&s<=135||s>=144&&s<=150||s>=224))||(U||(U=!0,clearTimeout(N),N=setTimeout(function(){S.show()},600),T.css("z-index",9998),S.on("mouseenter.focus",function(){e(),o.on("scroll.focus",function(){var e=t.pageYOffset;M&&L&&M!==e&&(L<X.top-Y||L>X.bottom+Y)&&g(),M=e})}).on("mouseleave.focus",function(){F=I=null,K=R=0,o.off("scroll.focus")}).on("mousemove.focus",function(e){var o=e.clientX,i=e.clientY,n=t.pageYOffset,s=t.pageXOffset;if(F&&I&&(o!==F||i!==I))if(i<=I&&i<X.top-n||i>=I&&i>X.bottom-n||o<=F&&o<X.left-s||o>=F&&o>X.right-s){if(K+=Math.abs(F-o),R+=Math.abs(I-i),(i<=X.top-Y-n||i>=X.bottom+Y-n||o<=X.left-Y-s||o>=X.right+Y-s)&&(K>10||R>10))return g(),F=I=null,void(K=R=0)}else K=R=0;F=o,I=i}).on("touchstart.focus",function(t){t.preventDefault(),g()}),T.off("mouseenter.focus"),V&&(clearTimeout(V),V=null),x.addClass("focus-on").removeClass("focus-off")),m(),H())}function g(t){U&&(U=!1,clearTimeout(N),N=setTimeout(function(){S.hide()},200),T.css("z-index",""),S.off("mouseenter.focus mouseleave.focus mousemove.focus touchstart.focus"),void 0===t&&T.on("mouseenter.focus",function(){($.contains(T.get(0),document.activeElement)||j)&&p()}),V=setTimeout(function(){V=null,T.off("mouseenter.focus")},1e3),x.addClass("focus-off").removeClass("focus-on")),w(),b()}function h(){setTimeout(function(){function t(t){return $.contains(t.get(0),document.activeElement)}var e=document.activeElement.compareDocumentPosition(T.get(0));2!==e&&4!==e||!(t(E)||t(y)||t(s))||g()},0)}function m(){!D&&U&&(D=!0,n.on("mouseenter.focus",function(){n.addClass("focus-off")}).on("mouseleave.focus",function(){n.removeClass("focus-off")}))}function w(){D&&(D=!1,n.off(".focus"))}function H(){P||!U||O.find(":focus").length||(P=!0,O.stop().fadeTo("fast",.3).on("mouseenter.focus",b).off("mouseleave.focus"),z.on("focus.focus",b).off("blur.focus"))}function b(){P&&(P=!1,O.stop().fadeTo("fast",1).on("mouseleave.focus",H).off("mouseenter.focus"),z.on("blur.focus",H).off("focus.focus"))}function v(t){t.altKey&&t.shiftKey&&87===t.keyCode&&r()}var x=$(document.body),y=$("#wpcontent"),T=$("#post-body-content"),B=$("#title"),C=$("#content"),S=$(document.createElement("DIV")),O=$("#edit-slug-box"),z=O.find("a").add(O.find("button")).add(O.find("input")),E=$("#adminmenuwrap"),_=$(),k=$(),A="on"===t.getUserSetting("editor_expand","on"),W=!!A&&"on"===t.getUserSetting("post_dfw"),K=0,R=0,Y=20,U,D,P,X,F,I,L,M,V,N,j;x.append(S),S.css({display:"none",position:"fixed",top:n.height(),right:0,bottom:0,left:0,"z-index":9997}),T.css({position:"relative"}),o.on("mousemove.focus",function(t){L=t.pageY}),$("#postdivrich").hasClass("wp-editor-expand")&&C.on("keydown.focus-shortcut",v),i.on("tinymce-editor-setup.focus",function(t,e){e.addButton("dfw",{active:W,classes:"wp-dfw btn widget",disabled:!A,onclick:r,onPostRender:function(){var t=this;i.on("dfw-activate.focus",function(){t.disabled(!1)}).on("dfw-deactivate.focus",function(){t.disabled(!0)}).on("dfw-on.focus",function(){t.active(!0)}).on("dfw-off.focus",function(){t.active(!1)})},tooltip:"Distraction-free writing mode",shortcut:"Alt+Shift+W"}),e.addCommand("wpToggleDFW",r),e.addShortcut("access+w","","wpToggleDFW")}),i.on("tinymce-editor-init.focus",function(t,o){function n(){j=!0}function s(){j=!1}var f,a;"content"===o.id&&(_=$(o.getWin()),k=$(o.getContentAreaContainer()).find("iframe"),f=function(){o.on("keydown",p),o.on("blur",h),o.on("focus",n),o.on("blur",s),o.on("wp-autoresize",e)},a=function(){o.off("keydown",p),o.off("blur",h),o.off("focus",n),o.off("blur",s),o.off("wp-autoresize",e)},W&&f(),i.on("dfw-on.focus",f).on("dfw-off.focus",a),o.on("click",function(t){t.target===o.getDoc().documentElement&&o.focus()}))}),i.on("quicktags-init",function(t,e){var o;e.settings.buttons&&-1!==(","+e.settings.buttons+",").indexOf(",dfw,")&&(o=$("#"+e.name+"_dfw"),$(document).on("dfw-activate",function(){o.prop("disabled",!1)}).on("dfw-deactivate",function(){o.prop("disabled",!0)}).on("dfw-on",function(){o.addClass("active")}).on("dfw-off",function(){o.removeClass("active")}))}),i.on("editor-expand-on.focus",f).on("editor-expand-off.focus",a),W&&(C.on("keydown.focus",p),B.add(C).on("blur.focus",h)),t.wp=t.wp||{},t.wp.editor=t.wp.editor||{},t.wp.editor.dfw={activate:f,deactivate:a,isActive:d,on:c,off:u,toggle:r,isOn:l}})}(window,window.jQuery);