!function(t){var e=window.tagsSuggestL10n&&window.tagsSuggestL10n.tagDelimiter||",";window.array_unique_noempty=function(e){var a=[];return t.each(e,function(e,s){(s=t.trim(s))&&-1===t.inArray(s,a)&&a.push(s)}),a},window.tagBox={clean:function(t){return","!==e&&(t=t.replace(new RegExp(e,"g"),",")),t=t.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,""),","!==e&&(t=t.replace(/,/g,e)),t},parseTags:function(a){var s,i=a.id.split("-check-num-")[1],n=t(a).closest(".tagsdiv"),c=n.find(".the-tags"),o=c.val().split(e),r=[];return delete o[i],t.each(o,function(e,a){(a=t.trim(a))&&r.push(a)}),c.val(this.clean(r.join(e))),this.quickClicks(n),!1},quickClicks:function(a){var s,i,n=t(".the-tags",a),c=t(".tagchecklist",a),o=t(a).attr("id");n.length&&(i=n.prop("disabled"),s=n.val().split(e),c.empty(),t.each(s,function(e,a){var s,n;(a=t.trim(a))&&(s=t("<li />").text(a),i||((n=t('<button type="button" id="'+o+"-check-num-"+e+'" class="ntdelbutton"><span class="remove-tag-icon" aria-hidden="true"></span><span class="screen-reader-text">'+window.tagsSuggestL10n.removeTerm+" "+s.html()+"</span></button>")).on("click keypress",function(e){"click"!==e.type&&13!==e.keyCode&&32!==e.keyCode||(13!==e.keyCode&&32!==e.keyCode||t(this).closest(".tagsdiv").find("input.newtag").focus(),tagBox.userAction="remove",tagBox.parseTags(this))}),s.prepend("&nbsp;").prepend(n)),c.append(s))}),tagBox.screenReadersMessage())},flushTags:function(a,s,i){var n,c,o,r=t(".the-tags",a),u=t("input.newtag",a);return void 0!==(o=(s=s||!1)?t(s).text():u.val())&&""!==o&&(c=(n=r.val())?n+e+o:o,c=this.clean(c),c=array_unique_noempty(c.split(e)).join(e),r.val(c),this.quickClicks(a),s||u.val(""),void 0===i&&u.focus(),!1)},get:function(e){var a=e.substr(e.indexOf("-")+1);t.post(ajaxurl,{action:"get-tagcloud",tax:a},function(s,i){0!==s&&"success"==i&&(s=t('<div id="tagcloud-'+a+'" class="the-tagcloud">'+s+"</div>"),t("a",s).click(function(){return tagBox.userAction="add",tagBox.flushTags(t("#"+a),this),!1}),t("#"+e).after(s))})},userAction:"",screenReadersMessage:function(){var t;switch(this.userAction){case"remove":t=window.tagsSuggestL10n.termRemoved;break;case"add":t=window.tagsSuggestL10n.termAdded;break;default:return}window.wp.a11y.speak(t,"assertive")},init:function(){var e=t("div.ajaxtag");t(".tagsdiv").each(function(){tagBox.quickClicks(this)}),t(".tagadd",e).click(function(){tagBox.userAction="add",tagBox.flushTags(t(this).closest(".tagsdiv"))}),t("input.newtag",e).keypress(function(e){13==e.which&&(tagBox.userAction="add",tagBox.flushTags(t(this).closest(".tagsdiv")),e.preventDefault(),e.stopPropagation())}).each(function(e,a){t(a).wpTagsSuggest()}),t("#post").submit(function(){t("div.tagsdiv").each(function(){tagBox.flushTags(this,!1,1)})}),t(".tagcloud-link").click(function(){tagBox.get(t(this).attr("id")),t(this).attr("aria-expanded","true").unbind().click(function(){t(this).attr("aria-expanded","false"===t(this).attr("aria-expanded")?"true":"false").siblings(".the-tagcloud").toggle()})})}}}(jQuery);