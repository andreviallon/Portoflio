var setCommentsList,theList,theExtraList,commentReply;!function($){var t,e,n,a,o,s,i,r=document.title,l=$("#dashboard_right_now").length,m,p;t=function(t){var e=parseInt(t.html().replace(/[^0-9]+/g,""),10);return isNaN(e)?0:e},e=function(t,e){var n="";if(!isNaN(e)){if(e=e<1?"0":e.toString(),e.length>3){for(;e.length>3;)n=thousandsSeparator+e.substr(e.length-3)+n,e=e.substr(0,e.length-3);e+=n}t.html(e)}},o=function(a,o){var s=".post-com-count-"+o,i="comment-count-no-comments",r="comment-count-approved",l,m;n("span.approved-count",a),o&&(l=$("span."+r,s),m=$("span."+i,s),l.each(function(){var n=$(this),o=t(n)+a;o<1&&(o=0),0===o?n.removeClass(r).addClass(i):n.addClass(r).removeClass(i),e(n,o)}),m.each(function(){var t=$(this);a>0?t.removeClass(i).addClass(r):t.addClass(i).removeClass(r),e(t,a)}))},n=function(n,a){$(n).each(function(){var n=$(this),o=t(n)+a;o<1&&(o=0),e(n,o)})},i=function(t){if(l&&t&&t.i18n_comments_text){var e=$("#dashboard_right_now");$(".comment-count a",e).text(t.i18n_comments_text),$(".comment-mod-count a",e).text(t.i18n_moderation_text).parent()[t.in_moderation>0?"removeClass":"addClass"]("hidden")}},s=function(n){var a,o,s,i;p=p||new RegExp(adminCommentsL10n.docTitleCommentsCount.replace("%s","\\([0-9"+thousandsSeparator+"]+\\)")+"?"),m=m||$("<div />"),a=r,i=p.exec(document.title),i?(i=i[0],m.html(i),s=t(m)+n):(m.html(0),s=n),s>=1?(e(m,s),(o=p.exec(document.title))&&(a=document.title.replace(o[0],adminCommentsL10n.docTitleCommentsCount.replace("%s",m.text())+" "))):(o=p.exec(a))&&(a=a.replace(o[0],adminCommentsL10n.docTitleComments)),document.title=a},a=function(n,a){var o=".post-com-count-"+a,i="comment-count-no-pending",r="post-com-count-no-pending",m="comment-count-pending",p,c;l||s(n),$("span.pending-count").each(function(){var a=$(this),o=t(a)+n;o<1&&(o=0),a.closest(".awaiting-mod")[0===o?"addClass":"removeClass"]("count-0"),e(a,o)}),a&&(p=$("span."+m,o),c=$("span."+i,o),p.each(function(){var a=$(this),o=t(a)+n;o<1&&(o=0),0===o?(a.parent().addClass(r),a.removeClass(m).addClass(i)):(a.parent().removeClass(r),a.addClass(m).removeClass(i)),e(a,o)}),c.each(function(){var t=$(this);n>0?(t.parent().removeClass(r),t.removeClass(i).addClass(m)):(t.parent().addClass(r),t.addClass(i).removeClass(m)),e(t,n)}))},setCommentsList=function(){var e,s,r,m,p,c,d,u,h,v=0;e=$('input[name="_total"]',"#comments-form"),s=$('input[name="_per_page"]',"#comments-form"),r=$('input[name="_page"]',"#comments-form"),c=function(t,n,a){n<v||(a&&(v=n),e.val(t.toString()))},m=function(t,e){var n,s,r,l,m=$("#"+e.element);!0!==e.parsed&&(l=e.parsed.responses[0]),n=$("#replyrow"),s=$("#comment_ID",n).val(),r=$("#replybtn",n),m.is(".unapproved")?(e.data.id==s&&r.text(adminCommentsL10n.replyApprove),m.find(".row-actions span.view").addClass("hidden").end().find("div.comment_status").html("0")):(e.data.id==s&&r.text(adminCommentsL10n.reply),m.find(".row-actions span.view").removeClass("hidden").end().find("div.comment_status").html("1")),h=$("#"+e.element).is("."+e.dimClass)?1:-1,l?(i(l.supplemental),a(h,l.supplemental.postId),o(-1*h,l.supplemental.postId)):(a(h),o(-1*h))},p=function(t,n){var a,o,i,l,m,p,c,d=!1,u=$(t.target).attr("data-wp-lists");return t.data._total=e.val()||0,t.data._per_page=s.val()||0,t.data._page=r.val()||0,t.data._url=document.location.href,t.data.comment_status=$('input[name="comment_status"]',"#comments-form").val(),-1!=u.indexOf(":trash=1")?d="trash":-1!=u.indexOf(":spam=1")&&(d="spam"),d&&(o=u.replace(/.*?comment-([0-9]+).*/,"$1"),i=$("#comment-"+o),a=$("#"+d+"-undo-holder").html(),i.find(".check-column :checkbox").prop("checked",!1),i.siblings("#replyrow").length&&commentReply.cid==o&&commentReply.close(),i.is("tr")?(l=i.children(":visible").length,c=$(".author strong",i).text(),m=$('<tr id="undo-'+o+'" class="undo un'+d+'" style="display:none;"><td colspan="'+l+'">'+a+"</td></tr>")):(c=$(".comment-author",i).text(),m=$('<div id="undo-'+o+'" style="display:none;" class="undo un'+d+'">'+a+"</div>")),i.before(m),$("strong","#undo-"+o).text(c),p=$(".undo a","#undo-"+o),p.attr("href","comment.php?action=un"+d+"comment&c="+o+"&_wpnonce="+t.data._ajax_nonce),p.attr("data-wp-lists","delete:the-comment-list:comment-"+o+"::un"+d+"=1"),p.attr("class","vim-z vim-destructive"),$(".avatar",i).first().clone().prependTo("#undo-"+o+" ."+d+"-undo-inside"),p.click(function(t){t.preventDefault(),t.stopPropagation(),n.wpList.del(this),$("#undo-"+o).css({backgroundColor:"#ceb"}).fadeOut(350,function(){$(this).remove(),$("#comment-"+o).css("backgroundColor","").fadeIn(300,function(){$(this).show()})})})),t},d=function(s,r){var m,p,d,h,f=!0===r.parsed?{}:r.parsed.responses[0],g=!0===r.parsed?"":f.supplemental.status,C=!0===r.parsed?"":f.supplemental.postId,_=!0===r.parsed?"":f.supplemental,y=$(r.target).parent(),w=$("#"+r.element),x,b,k,L,E=w.hasClass("approved"),I=w.hasClass("unapproved"),R=w.hasClass("spam"),T=w.hasClass("trash"),j=!1;i(_),y.is("span.undo")?(y.hasClass("unspam")?(x=-1,"trash"===g?b=1:"1"===g?L=1:"0"===g&&(k=1)):y.hasClass("untrash")&&(b=-1,"spam"===g?x=1:"1"===g?L=1:"0"===g&&(k=1)),j=!0):y.is("span.spam")?(E?L=-1:I?k=-1:T&&(b=-1),x=1):y.is("span.unspam")?(E?k=1:I?L=1:T?y.hasClass("approve")?L=1:y.hasClass("unapprove")&&(k=1):R&&(y.hasClass("approve")?L=1:y.hasClass("unapprove")&&(k=1)),x=-1):y.is("span.trash")?(E?L=-1:I?k=-1:R&&(x=-1),b=1):y.is("span.untrash")?(E?k=1:I?L=1:T&&(y.hasClass("approve")?L=1:y.hasClass("unapprove")&&(k=1)),b=-1):y.is("span.approve:not(.unspam):not(.untrash)")?(L=1,k=-1):y.is("span.unapprove:not(.unspam):not(.untrash)")?(L=-1,k=1):y.is("span.delete")&&(R?x=-1:T&&(b=-1)),k&&(a(k,C),n("span.all-count",k)),L&&(o(L,C),n("span.all-count",L)),x&&n("span.spam-count",x),b&&n("span.trash-count",b),("trash"===r.data.comment_status&&!t($("span.trash-count"))||"spam"===r.data.comment_status&&!t($("span.spam-count")))&&$("#delete_all").hide(),l||(p=e.val()?parseInt(e.val(),10):0,$(r.target).parent().is("span.undo")?p++:p--,p<0&&(p=0),"object"==typeof s?f.supplemental.total_items_i18n&&v<f.supplemental.time?(m=f.supplemental.total_items_i18n||"",m&&($(".displaying-num").text(m),$(".total-pages").text(f.supplemental.total_pages_i18n),$(".tablenav-pages").find(".next-page, .last-page").toggleClass("disabled",f.supplemental.total_pages==$(".current-page").val())),c(p,f.supplemental.time,!0)):f.supplemental.time&&c(p,f.supplemental.time,!1):c(p,s,!1)),theExtraList&&0!==theExtraList.length&&0!==theExtraList.children().length&&!j&&(theList.get(0).wpList.add(theExtraList.children(":eq(0):not(.no-items)").remove().clone()),u(),d=$(":animated","#the-comment-list"),h=function(){$("#the-comment-list tr:visible").length||theList.get(0).wpList.add(theExtraList.find(".no-items").clone())},d.length?d.promise().done(h):h())},u=function(t){var e=$.query.get(),n=$(".total-pages").text(),a=$('input[name="_per_page"]',"#comments-form").val();e.paged||(e.paged=1),e.paged>n||(t?(theExtraList.empty(),e.number=Math.min(8,a)):(e.number=1,e.offset=Math.min(8,a)-1),e.no_placeholder=!0,e.paged++,!0===e.comment_type&&(e.comment_type=""),e=$.extend(e,{action:"fetch-list",list_args:list_args,_ajax_fetch_list_nonce:$("#_ajax_fetch_list_nonce").val()}),$.ajax({url:ajaxurl,global:!1,dataType:"json",data:e,success:function(t){theExtraList.get(0).wpList.add(t.rows)}}))},theExtraList=$("#the-extra-comment-list").wpList({alt:"",delColor:"none",addColor:"none"}),theList=$("#the-comment-list").wpList({alt:"",delBefore:p,dimAfter:m,delAfter:d,addColor:"none"}).bind("wpListDelEnd",function(t,e){var n=$(e.target).attr("data-wp-lists"),a=e.element.replace(/[^0-9]+/g,"");-1==n.indexOf(":trash=1")&&-1==n.indexOf(":spam=1")||$("#undo-"+a).fadeIn(300,function(){$(this).show()})})},commentReply={cid:"",act:"",originalContent:"",init:function(){var t=$("#replyrow");$("a.cancel",t).click(function(){return commentReply.revert()}),$("a.save",t).click(function(){return commentReply.send()}),$("input#author-name, input#author-email, input#author-url",t).keypress(function(t){if(13==t.which)return commentReply.send(),t.preventDefault(),!1}),$("#the-comment-list .column-comment > p").dblclick(function(){commentReply.toggle($(this).parent())}),$("#doaction, #doaction2, #post-query-submit").click(function(){$("#the-comment-list #replyrow").length>0&&commentReply.close()}),this.comments_listing=$('#comments-form > input[name="comment_status"]').val()||""},addEvents:function(t){t.each(function(){$(this).find(".column-comment > p").dblclick(function(){commentReply.toggle($(this).parent())})})},toggle:function(t){"none"!==$(t).css("display")&&($("#replyrow").parent().is("#com-reply")||window.confirm(adminCommentsL10n.warnQuickEdit))&&$(t).find("a.vim-q").click()},revert:function(){return!($("#the-comment-list #replyrow").length<1)&&($("#replyrow").fadeOut("fast",function(){commentReply.close()}),!1)},close:function(){var t,e=$("#replyrow");e.parent().is("#com-reply")||(this.cid&&"edit-comment"==this.act&&(t=$("#comment-"+this.cid),t.fadeIn(300,function(){t.show()}).css("backgroundColor","")),"undefined"!=typeof QTags&&QTags.closeAllTags("replycontent"),$("#add-new-comment").css("display",""),e.hide(),$("#com-reply").append(e),$("#replycontent").css("height","").val(""),$("#edithead input").val(""),$(".notice-error",e).addClass("hidden").find(".error").empty(),$(".spinner",e).removeClass("is-active"),this.cid="",this.originalContent="")},open:function(t,e,n){var a,o,s,i,r,l=this,m=$("#comment-"+t),p=m.height(),c=0;return!!this.discardCommentChanges()&&(l.close(),l.cid=t,a=$("#replyrow"),o=$("#inline-"+t),n=n||"replyto",s="edit"==n?"edit":"replyto",s=l.act=s+"-comment",l.originalContent=$("textarea.comment",o).val(),c=$("> th:visible, > td:visible",m).length,a.hasClass("inline-edit-row")&&0!==c&&$("td",a).attr("colspan",c),$("#action",a).val(s),$("#comment_post_ID",a).val(e),$("#comment_ID",a).val(t),"edit"==n?($("#author-name",a).val($("div.author",o).text()),$("#author-email",a).val($("div.author-email",o).text()),$("#author-url",a).val($("div.author-url",o).text()),$("#status",a).val($("div.comment_status",o).text()),$("#replycontent",a).val($("textarea.comment",o).val()),$("#edithead, #editlegend, #savebtn",a).show(),$("#replyhead, #replybtn, #addhead, #addbtn",a).hide(),p>120&&(r=p>500?500:p,$("#replycontent",a).css("height",r+"px")),m.after(a).fadeOut("fast",function(){$("#replyrow").fadeIn(300,function(){$(this).show()})})):"add"==n?($("#addhead, #addbtn",a).show(),$("#replyhead, #replybtn, #edithead, #editlegend, #savebtn",a).hide(),$("#the-comment-list").prepend(a),$("#replyrow").fadeIn(300)):(i=$("#replybtn",a),$("#edithead, #editlegend, #savebtn, #addhead, #addbtn",a).hide(),$("#replyhead, #replybtn",a).show(),m.after(a),m.hasClass("unapproved")?i.text(adminCommentsL10n.replyApprove):i.text(adminCommentsL10n.reply),$("#replyrow").fadeIn(300,function(){$(this).show()})),setTimeout(function(){var t,e,n,a,o;t=$("#replyrow").offset().top,e=t+$("#replyrow").height(),n=window.pageYOffset||document.documentElement.scrollTop,a=document.documentElement.clientHeight||window.innerHeight||0,o=n+a,o-20<e?window.scroll(0,e-a+35):t-20<n&&window.scroll(0,t-35),$("#replycontent").focus().keyup(function(t){27==t.which&&commentReply.revert()})},600),!1)},send:function(){var t={};return $("#replysubmit .error-notice").addClass("hidden"),$("#replysubmit .spinner").addClass("is-active"),$("#replyrow input").not(":button").each(function(){var e=$(this);t[e.attr("name")]=e.val()}),t.content=$("#replycontent").val(),t.id=t.comment_post_ID,t.comments_listing=this.comments_listing,t.p=$('[name="p"]').val(),$("#comment-"+$("#comment_ID").val()).hasClass("unapproved")&&(t.approve_parent=1),$.ajax({type:"POST",url:ajaxurl,data:t,success:function(t){commentReply.show(t)},error:function(t){commentReply.error(t)}}),!1},show:function(t){var e=this,s,r,m,p,c;return"string"==typeof t?(e.error({responseText:t}),!1):(s=wpAjax.parseAjaxResponse(t),s.errors?(e.error({responseText:wpAjax.broken}),!1):(e.revert(),s=s.responses[0],m="#comment-"+s.id,"edit-comment"==e.act&&$(m).remove(),s.supplemental.parent_approved&&(c=$("#comment-"+s.supplemental.parent_approved),a(-1,s.supplemental.parent_post_id),"moderated"==this.comments_listing)?void c.animate({backgroundColor:"#CCEEBB"},400,function(){c.fadeOut()}):(s.supplemental.i18n_comments_text&&(l?i(s.supplemental):(o(1,s.supplemental.parent_post_id),n("span.all-count",1))),r=$.trim(s.data),$(r).hide(),$("#replyrow").after(r),m=$(m),e.addEvents(m),p=m.hasClass("unapproved")?"#FFFFE0":m.closest(".widefat, .postbox").css("backgroundColor"),void m.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:p},300,function(){c&&c.length&&c.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:p},300).removeClass("unapproved").addClass("approved").find("div.comment_status").html("1")}))))},error:function(t){var e=t.statusText,n=$("#replysubmit .notice-error"),a=n.find(".error");$("#replysubmit .spinner").removeClass("is-active"),t.responseText&&(e=t.responseText.replace(/<.[^<>]*?>/g,"")),e&&(n.removeClass("hidden"),a.html(e))},addcomment:function(t){var e=this;$("#add-new-comment").fadeOut(200,function(){e.open(0,t,"add"),$("table.comments-box").css("display",""),$("#no-comments").remove()})},discardCommentChanges:function(){var t=$("#replyrow");return this.originalContent===$("#replycontent",t).val()||window.confirm(adminCommentsL10n.warnCommentChanges)}},$(document).ready(function(){var t,e,n,a;setCommentsList(),commentReply.init(),$(document).on("click","span.delete a.delete",function(t){t.preventDefault()}),void 0!==$.table_hotkeys&&(t=function(t){return function(){var e,n;e="next"==t?"first":"last",n=$(".tablenav-pages ."+t+"-page:not(.disabled)"),n.length&&(window.location=n[0].href.replace(/\&hotkeys_highlight_(first|last)=1/g,"")+"&hotkeys_highlight_"+e+"=1")}},e=function(t,e){window.location=$("span.edit a",e).attr("href")},n=function(){$("#cb-select-all-1").data("wp-toggle",1).trigger("click").removeData("wp-toggle")},a=function(t){return function(){var e=$('select[name="action"]');$('option[value="'+t+'"]',e).prop("selected",!0),$("#doaction").click()}},$.table_hotkeys($("table.widefat"),["a","u","s","d","r","q","z",["e",e],["shift+x",n],["shift+a",a("approve")],["shift+s",a("spam")],["shift+d",a("delete")],["shift+t",a("trash")],["shift+z",a("untrash")],["shift+u",a("unapprove")]],{highlight_first:adminCommentsL10n.hotkeys_highlight_first,highlight_last:adminCommentsL10n.hotkeys_highlight_last,prev_page_link_cb:t("prev"),next_page_link_cb:t("next"),hotkeys_opts:{disableInInput:!0,type:"keypress",noDisable:'.check-column input[type="checkbox"]'},cycle_expr:"#the-comment-list tr",start_row_index:0})),$("#the-comment-list").on("click",".comment-inline",function(t){t.preventDefault();var e=$(this),n="replyto";void 0!==e.data("action")&&(n=e.data("action")),commentReply.open(e.data("commentId"),e.data("postId"),n)})})}(jQuery);