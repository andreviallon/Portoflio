var setCommentsList,theList,theExtraList,commentReply;!function(t){var e,n,a,o,s,i,r,l=document.title,m=t("#dashboard_right_now").length,p,c;e=function(t){var e=parseInt(t.html().replace(/[^0-9]+/g,""),10);return isNaN(e)?0:e},n=function(t,e){var n="";if(!isNaN(e)){if((e=e<1?"0":e.toString()).length>3){for(;e.length>3;)n=thousandsSeparator+e.substr(e.length-3)+n,e=e.substr(0,e.length-3);e+=n}t.html(e)}},s=function(o,s){var i=".post-com-count-"+s,r="comment-count-no-comments",l="comment-count-approved",m,p;a("span.approved-count",o),s&&(m=t("span."+l,i),p=t("span."+r,i),m.each(function(){var a=t(this),s=e(a)+o;s<1&&(s=0),0===s?a.removeClass(l).addClass(r):a.addClass(l).removeClass(r),n(a,s)}),p.each(function(){var e=t(this);o>0?e.removeClass(r).addClass(l):e.addClass(r).removeClass(l),n(e,o)}))},a=function(a,o){t(a).each(function(){var a=t(this),s=e(a)+o;s<1&&(s=0),n(a,s)})},r=function(e){if(m&&e&&e.i18n_comments_text){var n=t("#dashboard_right_now");t(".comment-count a",n).text(e.i18n_comments_text),t(".comment-mod-count a",n).text(e.i18n_moderation_text).parent()[e.in_moderation>0?"removeClass":"addClass"]("hidden")}},i=function(a){var o,s,i,r;c=c||new RegExp(adminCommentsL10n.docTitleCommentsCount.replace("%s","\\([0-9"+thousandsSeparator+"]+\\)")+"?"),p=p||t("<div />"),o=l,(r=c.exec(document.title))?(r=r[0],p.html(r),i=e(p)+a):(p.html(0),i=a),i>=1?(n(p,i),(s=c.exec(document.title))&&(o=document.title.replace(s[0],adminCommentsL10n.docTitleCommentsCount.replace("%s",p.text())+" "))):(s=c.exec(o))&&(o=o.replace(s[0],adminCommentsL10n.docTitleComments)),document.title=o},o=function(a,o){var s=".post-com-count-"+o,r="comment-count-no-pending",l="post-com-count-no-pending",p="comment-count-pending",c,d;m||i(a),t("span.pending-count").each(function(){var o=t(this),s=e(o)+a;s<1&&(s=0),o.closest(".awaiting-mod")[0===s?"addClass":"removeClass"]("count-0"),n(o,s)}),o&&(c=t("span."+p,s),d=t("span."+r,s),c.each(function(){var o=t(this),s=e(o)+a;s<1&&(s=0),0===s?(o.parent().addClass(l),o.removeClass(p).addClass(r)):(o.parent().removeClass(l),o.addClass(p).removeClass(r)),n(o,s)}),d.each(function(){var e=t(this);a>0?(e.parent().removeClass(l),e.removeClass(r).addClass(p)):(e.parent().addClass(l),e.addClass(r).removeClass(p)),n(e,a)}))},setCommentsList=function(){var n,i,l,p,c,d,u,h,v,f=0;n=t('input[name="_total"]',"#comments-form"),i=t('input[name="_per_page"]',"#comments-form"),l=t('input[name="_page"]',"#comments-form"),d=function(t,e,a){e<f||(a&&(f=e),n.val(t.toString()))},p=function(e,n){var a,i,l,m,p=t("#"+n.element);!0!==n.parsed&&(m=n.parsed.responses[0]),a=t("#replyrow"),i=t("#comment_ID",a).val(),l=t("#replybtn",a),p.is(".unapproved")?(n.data.id==i&&l.text(adminCommentsL10n.replyApprove),p.find(".row-actions span.view").addClass("hidden").end().find("div.comment_status").html("0")):(n.data.id==i&&l.text(adminCommentsL10n.reply),p.find(".row-actions span.view").removeClass("hidden").end().find("div.comment_status").html("1")),v=t("#"+n.element).is("."+n.dimClass)?1:-1,m?(r(m.supplemental),o(v,m.supplemental.postId),s(-1*v,m.supplemental.postId)):(o(v),s(-1*v))},c=function(e,a){var o,s,r,m,p,c,d,u=!1,h=t(e.target).attr("data-wp-lists");return e.data._total=n.val()||0,e.data._per_page=i.val()||0,e.data._page=l.val()||0,e.data._url=document.location.href,e.data.comment_status=t('input[name="comment_status"]',"#comments-form").val(),-1!=h.indexOf(":trash=1")?u="trash":-1!=h.indexOf(":spam=1")&&(u="spam"),u&&(s=h.replace(/.*?comment-([0-9]+).*/,"$1"),r=t("#comment-"+s),o=t("#"+u+"-undo-holder").html(),r.find(".check-column :checkbox").prop("checked",!1),r.siblings("#replyrow").length&&commentReply.cid==s&&commentReply.close(),r.is("tr")?(m=r.children(":visible").length,d=t(".author strong",r).text(),p=t('<tr id="undo-'+s+'" class="undo un'+u+'" style="display:none;"><td colspan="'+m+'">'+o+"</td></tr>")):(d=t(".comment-author",r).text(),p=t('<div id="undo-'+s+'" style="display:none;" class="undo un'+u+'">'+o+"</div>")),r.before(p),t("strong","#undo-"+s).text(d),(c=t(".undo a","#undo-"+s)).attr("href","comment.php?action=un"+u+"comment&c="+s+"&_wpnonce="+e.data._ajax_nonce),c.attr("data-wp-lists","delete:the-comment-list:comment-"+s+"::un"+u+"=1"),c.attr("class","vim-z vim-destructive"),t(".avatar",r).first().clone().prependTo("#undo-"+s+" ."+u+"-undo-inside"),c.click(function(e){e.preventDefault(),e.stopPropagation(),a.wpList.del(this),t("#undo-"+s).css({backgroundColor:"#ceb"}).fadeOut(350,function(){t(this).remove(),t("#comment-"+s).css("backgroundColor","").fadeIn(300,function(){t(this).show()})})})),e},u=function(i,l){var p,c,u,v,g=!0===l.parsed?{}:l.parsed.responses[0],C=!0===l.parsed?"":g.supplemental.status,_=!0===l.parsed?"":g.supplemental.postId,y=!0===l.parsed?"":g.supplemental,w=t(l.target).parent(),x=t("#"+l.element),b,k,L,E,I=x.hasClass("approved"),R=x.hasClass("unapproved"),T=x.hasClass("spam"),j=x.hasClass("trash"),D=!1;r(y),w.is("span.undo")?(w.hasClass("unspam")?(b=-1,"trash"===C?k=1:"1"===C?E=1:"0"===C&&(L=1)):w.hasClass("untrash")&&(k=-1,"spam"===C?b=1:"1"===C?E=1:"0"===C&&(L=1)),D=!0):w.is("span.spam")?(I?E=-1:R?L=-1:j&&(k=-1),b=1):w.is("span.unspam")?(I?L=1:R?E=1:j?w.hasClass("approve")?E=1:w.hasClass("unapprove")&&(L=1):T&&(w.hasClass("approve")?E=1:w.hasClass("unapprove")&&(L=1)),b=-1):w.is("span.trash")?(I?E=-1:R?L=-1:T&&(b=-1),k=1):w.is("span.untrash")?(I?L=1:R?E=1:j&&(w.hasClass("approve")?E=1:w.hasClass("unapprove")&&(L=1)),k=-1):w.is("span.approve:not(.unspam):not(.untrash)")?(E=1,L=-1):w.is("span.unapprove:not(.unspam):not(.untrash)")?(E=-1,L=1):w.is("span.delete")&&(T?b=-1:j&&(k=-1)),L&&(o(L,_),a("span.all-count",L)),E&&(s(E,_),a("span.all-count",E)),b&&a("span.spam-count",b),k&&a("span.trash-count",k),("trash"===l.data.comment_status&&!e(t("span.trash-count"))||"spam"===l.data.comment_status&&!e(t("span.spam-count")))&&t("#delete_all").hide(),m||(c=n.val()?parseInt(n.val(),10):0,t(l.target).parent().is("span.undo")?c++:c--,c<0&&(c=0),"object"==typeof i?g.supplemental.total_items_i18n&&f<g.supplemental.time?((p=g.supplemental.total_items_i18n||"")&&(t(".displaying-num").text(p),t(".total-pages").text(g.supplemental.total_pages_i18n),t(".tablenav-pages").find(".next-page, .last-page").toggleClass("disabled",g.supplemental.total_pages==t(".current-page").val())),d(c,g.supplemental.time,!0)):g.supplemental.time&&d(c,g.supplemental.time,!1):d(c,i,!1)),theExtraList&&0!==theExtraList.length&&0!==theExtraList.children().length&&!D&&(theList.get(0).wpList.add(theExtraList.children(":eq(0):not(.no-items)").remove().clone()),h(),v=function(){t("#the-comment-list tr:visible").length||theList.get(0).wpList.add(theExtraList.find(".no-items").clone())},(u=t(":animated","#the-comment-list")).length?u.promise().done(v):v())},h=function(e){var n=t.query.get(),a=t(".total-pages").text(),o=t('input[name="_per_page"]',"#comments-form").val();n.paged||(n.paged=1),n.paged>a||(e?(theExtraList.empty(),n.number=Math.min(8,o)):(n.number=1,n.offset=Math.min(8,o)-1),n.no_placeholder=!0,n.paged++,!0===n.comment_type&&(n.comment_type=""),n=t.extend(n,{action:"fetch-list",list_args:list_args,_ajax_fetch_list_nonce:t("#_ajax_fetch_list_nonce").val()}),t.ajax({url:ajaxurl,global:!1,dataType:"json",data:n,success:function(t){theExtraList.get(0).wpList.add(t.rows)}}))},theExtraList=t("#the-extra-comment-list").wpList({alt:"",delColor:"none",addColor:"none"}),theList=t("#the-comment-list").wpList({alt:"",delBefore:c,dimAfter:p,delAfter:u,addColor:"none"}).bind("wpListDelEnd",function(e,n){var a=t(n.target).attr("data-wp-lists"),o=n.element.replace(/[^0-9]+/g,"");-1==a.indexOf(":trash=1")&&-1==a.indexOf(":spam=1")||t("#undo-"+o).fadeIn(300,function(){t(this).show()})})},commentReply={cid:"",act:"",originalContent:"",init:function(){var e=t("#replyrow");t("a.cancel",e).click(function(){return commentReply.revert()}),t("a.save",e).click(function(){return commentReply.send()}),t("input#author-name, input#author-email, input#author-url",e).keypress(function(t){if(13==t.which)return commentReply.send(),t.preventDefault(),!1}),t("#the-comment-list .column-comment > p").dblclick(function(){commentReply.toggle(t(this).parent())}),t("#doaction, #doaction2, #post-query-submit").click(function(){t("#the-comment-list #replyrow").length>0&&commentReply.close()}),this.comments_listing=t('#comments-form > input[name="comment_status"]').val()||""},addEvents:function(e){e.each(function(){t(this).find(".column-comment > p").dblclick(function(){commentReply.toggle(t(this).parent())})})},toggle:function(e){"none"!==t(e).css("display")&&(t("#replyrow").parent().is("#com-reply")||window.confirm(adminCommentsL10n.warnQuickEdit))&&t(e).find("a.vim-q").click()},revert:function(){return!(t("#the-comment-list #replyrow").length<1)&&(t("#replyrow").fadeOut("fast",function(){commentReply.close()}),!1)},close:function(){var e,n=t("#replyrow");n.parent().is("#com-reply")||(this.cid&&"edit-comment"==this.act&&(e=t("#comment-"+this.cid)).fadeIn(300,function(){e.show()}).css("backgroundColor",""),"undefined"!=typeof QTags&&QTags.closeAllTags("replycontent"),t("#add-new-comment").css("display",""),n.hide(),t("#com-reply").append(n),t("#replycontent").css("height","").val(""),t("#edithead input").val(""),t(".notice-error",n).addClass("hidden").find(".error").empty(),t(".spinner",n).removeClass("is-active"),this.cid="",this.originalContent="")},open:function(e,n,a){var o,s,i,r,l,m=this,p=t("#comment-"+e),c=p.height(),d=0;return!!this.discardCommentChanges()&&(m.close(),m.cid=e,o=t("#replyrow"),s=t("#inline-"+e),i="edit"==(a=a||"replyto")?"edit":"replyto",i=m.act=i+"-comment",m.originalContent=t("textarea.comment",s).val(),d=t("> th:visible, > td:visible",p).length,o.hasClass("inline-edit-row")&&0!==d&&t("td",o).attr("colspan",d),t("#action",o).val(i),t("#comment_post_ID",o).val(n),t("#comment_ID",o).val(e),"edit"==a?(t("#author-name",o).val(t("div.author",s).text()),t("#author-email",o).val(t("div.author-email",s).text()),t("#author-url",o).val(t("div.author-url",s).text()),t("#status",o).val(t("div.comment_status",s).text()),t("#replycontent",o).val(t("textarea.comment",s).val()),t("#edithead, #editlegend, #savebtn",o).show(),t("#replyhead, #replybtn, #addhead, #addbtn",o).hide(),c>120&&(l=c>500?500:c,t("#replycontent",o).css("height",l+"px")),p.after(o).fadeOut("fast",function(){t("#replyrow").fadeIn(300,function(){t(this).show()})})):"add"==a?(t("#addhead, #addbtn",o).show(),t("#replyhead, #replybtn, #edithead, #editlegend, #savebtn",o).hide(),t("#the-comment-list").prepend(o),t("#replyrow").fadeIn(300)):(r=t("#replybtn",o),t("#edithead, #editlegend, #savebtn, #addhead, #addbtn",o).hide(),t("#replyhead, #replybtn",o).show(),p.after(o),p.hasClass("unapproved")?r.text(adminCommentsL10n.replyApprove):r.text(adminCommentsL10n.reply),t("#replyrow").fadeIn(300,function(){t(this).show()})),setTimeout(function(){var e,n,a,o,s;n=(e=t("#replyrow").offset().top)+t("#replyrow").height(),(s=(a=window.pageYOffset||document.documentElement.scrollTop)+(o=document.documentElement.clientHeight||window.innerHeight||0))-20<n?window.scroll(0,n-o+35):e-20<a&&window.scroll(0,e-35),t("#replycontent").focus().keyup(function(t){27==t.which&&commentReply.revert()})},600),!1)},send:function(){var e={},n;return t("#replysubmit .error-notice").addClass("hidden"),t("#replysubmit .spinner").addClass("is-active"),t("#replyrow input").not(":button").each(function(){var n=t(this);e[n.attr("name")]=n.val()}),e.content=t("#replycontent").val(),e.id=e.comment_post_ID,e.comments_listing=this.comments_listing,e.p=t('[name="p"]').val(),t("#comment-"+t("#comment_ID").val()).hasClass("unapproved")&&(e.approve_parent=1),t.ajax({type:"POST",url:ajaxurl,data:e,success:function(t){commentReply.show(t)},error:function(t){commentReply.error(t)}}),!1},show:function(e){var n=this,i,l,p,c,d;return"string"==typeof e?(n.error({responseText:e}),!1):(i=wpAjax.parseAjaxResponse(e)).errors?(n.error({responseText:wpAjax.broken}),!1):(n.revert(),p="#comment-"+(i=i.responses[0]).id,"edit-comment"==n.act&&t(p).remove(),void(i.supplemental.parent_approved&&(d=t("#comment-"+i.supplemental.parent_approved),o(-1,i.supplemental.parent_post_id),"moderated"==this.comments_listing)?d.animate({backgroundColor:"#CCEEBB"},400,function(){d.fadeOut()}):(i.supplemental.i18n_comments_text&&(m?r(i.supplemental):(s(1,i.supplemental.parent_post_id),a("span.all-count",1))),l=t.trim(i.data),t(l).hide(),t("#replyrow").after(l),p=t(p),n.addEvents(p),c=p.hasClass("unapproved")?"#FFFFE0":p.closest(".widefat, .postbox").css("backgroundColor"),p.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:c},300,function(){d&&d.length&&d.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:c},300).removeClass("unapproved").addClass("approved").find("div.comment_status").html("1")}))))},error:function(e){var n=e.statusText,a=t("#replysubmit .notice-error"),o=a.find(".error");t("#replysubmit .spinner").removeClass("is-active"),e.responseText&&(n=e.responseText.replace(/<.[^<>]*?>/g,"")),n&&(a.removeClass("hidden"),o.html(n))},addcomment:function(e){var n=this;t("#add-new-comment").fadeOut(200,function(){n.open(0,e,"add"),t("table.comments-box").css("display",""),t("#no-comments").remove()})},discardCommentChanges:function(){var e=t("#replyrow");return this.originalContent===t("#replycontent",e).val()||window.confirm(adminCommentsL10n.warnCommentChanges)}},t(document).ready(function(){var e,n,a,o;setCommentsList(),commentReply.init(),t(document).on("click","span.delete a.delete",function(t){t.preventDefault()}),void 0!==t.table_hotkeys&&(e=function(e){return function(){var n,a;n="next"==e?"first":"last",(a=t(".tablenav-pages ."+e+"-page:not(.disabled)")).length&&(window.location=a[0].href.replace(/\&hotkeys_highlight_(first|last)=1/g,"")+"&hotkeys_highlight_"+n+"=1")}},n=function(e,n){window.location=t("span.edit a",n).attr("href")},a=function(){t("#cb-select-all-1").data("wp-toggle",1).trigger("click").removeData("wp-toggle")},o=function(e){return function(){var n=t('select[name="action"]');t('option[value="'+e+'"]',n).prop("selected",!0),t("#doaction").click()}},t.table_hotkeys(t("table.widefat"),["a","u","s","d","r","q","z",["e",n],["shift+x",a],["shift+a",o("approve")],["shift+s",o("spam")],["shift+d",o("delete")],["shift+t",o("trash")],["shift+z",o("untrash")],["shift+u",o("unapprove")]],{highlight_first:adminCommentsL10n.hotkeys_highlight_first,highlight_last:adminCommentsL10n.hotkeys_highlight_last,prev_page_link_cb:e("prev"),next_page_link_cb:e("next"),hotkeys_opts:{disableInInput:!0,type:"keypress",noDisable:'.check-column input[type="checkbox"]'},cycle_expr:"#the-comment-list tr",start_row_index:0})),t("#the-comment-list").on("click",".comment-inline",function(e){e.preventDefault();var n=t(this),a="replyto";void 0!==n.data("action")&&(a=n.data("action")),commentReply.open(n.data("commentId"),n.data("postId"),a)})})}(jQuery);