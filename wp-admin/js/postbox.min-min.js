!function(e){var o=e(document);window.postboxes={handle_click:function(){var t,s=e(this),a=s.parent(".postbox"),n=a.attr("id");"dashboard_browser_nag"!==n&&(a.toggleClass("closed"),t=!a.hasClass("closed"),s.hasClass("handlediv")?s.attr("aria-expanded",t):s.closest(".postbox").find("button.handlediv").attr("aria-expanded",t),"press-this"!==postboxes.page&&postboxes.save_state(postboxes.page),n&&(!a.hasClass("closed")&&e.isFunction(postboxes.pbshow)?postboxes.pbshow(n):a.hasClass("closed")&&e.isFunction(postboxes.pbhide)&&postboxes.pbhide(n)),o.trigger("postbox-toggled",a))},add_postbox_toggles:function(t,s){var a=e(".postbox .hndle, .postbox .handlediv");this.page=t,this.init(t,s),a.on("click.postboxes",this.handle_click),e(".postbox .hndle a").click(function(e){e.stopPropagation()}),e(".postbox a.dismiss").on("click.postboxes",function(o){var t=e(this).parents(".postbox").attr("id")+"-hide";o.preventDefault(),e("#"+t).prop("checked",!1).triggerHandler("click")}),e(".hide-postbox-tog").bind("click.postboxes",function(){var s=e(this),a=s.val(),n=e("#"+a);s.prop("checked")?(n.show(),e.isFunction(postboxes.pbshow)&&postboxes.pbshow(a)):(n.hide(),e.isFunction(postboxes.pbhide)&&postboxes.pbhide(a)),postboxes.save_state(t),postboxes._mark_area(),o.trigger("postbox-toggled",n)}),e('.columns-prefs input[type="radio"]').bind("click.postboxes",function(){var o=parseInt(e(this).val(),10);o&&(postboxes._pb_edit(o),postboxes.save_order(t))})},init:function(t,s){var a=e(document.body).hasClass("mobile"),n=e(".postbox .handlediv");e.extend(this,s||{}),e("#wpbody-content").css("overflow","hidden"),e(".meta-box-sortables").sortable({placeholder:"sortable-placeholder",connectWith:".meta-box-sortables",items:".postbox",handle:".hndle",cursor:"move",delay:a?200:0,distance:2,tolerance:"pointer",forcePlaceholderSize:!0,helper:function(e,o){return o.clone().find(":input").attr("name",function(e,o){return"sort_"+parseInt(1e5*Math.random(),10).toString()+"_"+o}).end()},opacity:.65,stop:function(){var o=e(this);return o.find("#dashboard_browser_nag").is(":visible")&&"dashboard_browser_nag"!=this.firstChild.id?void o.sortable("cancel"):void postboxes.save_order(t)},receive:function(t,s){"dashboard_browser_nag"==s.item[0].id&&e(s.sender).sortable("cancel"),postboxes._mark_area(),o.trigger("postbox-moved",s.item)}}),a&&(e(document.body).bind("orientationchange.postboxes",function(){postboxes._pb_change()}),this._pb_change()),this._mark_area(),n.each(function(){var o=e(this);o.attr("aria-expanded",!o.parent(".postbox").hasClass("closed"))})},save_state:function(o){var t,s;"nav-menus"!==o&&(t=e(".postbox").filter(".closed").map(function(){return this.id}).get().join(","),s=e(".postbox").filter(":hidden").map(function(){return this.id}).get().join(","),e.post(ajaxurl,{action:"closed-postboxes",closed:t,hidden:s,closedpostboxesnonce:jQuery("#closedpostboxesnonce").val(),page:o}))},save_order:function(o){var t,s=e(".columns-prefs input:checked").val()||0;t={action:"meta-box-order",_ajax_nonce:e("#meta-box-order-nonce").val(),page_columns:s,page:o},e(".meta-box-sortables").each(function(){t["order["+this.id.split("-")[0]+"]"]=e(this).sortable("toArray").join(",")}),e.post(ajaxurl,t)},_mark_area:function(){var o=e("div.postbox:visible").length,t=e("#post-body #side-sortables");e("#dashboard-widgets .meta-box-sortables:visible").each(function(){var t=e(this);1==o||t.children(".postbox:visible").length?t.removeClass("empty-container"):(t.addClass("empty-container"),t.attr("data-emptyString",postBoxL10n.postBoxEmptyString))}),t.length&&(t.children(".postbox:visible").length?t.removeClass("empty-container"):"280px"==e("#postbox-container-1").css("width")&&t.addClass("empty-container"))},_pb_edit:function(o){var t=e(".metabox-holder").get(0);t&&(t.className=t.className.replace(/columns-\d+/,"columns-"+o)),e(document).trigger("postboxes-columnchange")},_pb_change:function(){var o=e('label.columns-prefs-1 input[type="radio"]');switch(window.orientation){case 90:case-90:o.length&&o.is(":checked")||this._pb_edit(2);break;case 0:case 180:e("#poststuff").length?this._pb_edit(1):o.length&&o.is(":checked")||this._pb_edit(2)}},pbshow:!1,pbhide:!1}}(jQuery);