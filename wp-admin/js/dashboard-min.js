var ajaxWidgets,ajaxPopulateWidgets,quickPressLoad;window.wp=window.wp||{},jQuery(document).ready(function($){function e(){if(!(document.documentMode&&document.documentMode<9)){$("body").append('<div class="quick-draft-textarea-clone" style="display: none;"></div>');var e=$(".quick-draft-textarea-clone"),t=$("#content"),n=t.height(),o=$(window).height()-100;e.css({"font-family":t.css("font-family"),"font-size":t.css("font-size"),"line-height":t.css("line-height"),"padding-bottom":t.css("paddingBottom"),"padding-left":t.css("paddingLeft"),"padding-right":t.css("paddingRight"),"padding-top":t.css("paddingTop"),"white-space":"pre-wrap","word-wrap":"break-word",display:"none"}),t.on("focus input propertychange",function(){var i=$(this),a=i.val()+"&nbsp;",s=e.css("width",i.css("width")).text(a).outerHeight()+2;t.css("overflow-y","auto"),s===n||s>=o&&n>=o||(n=s>o?o:s,t.css("overflow","hidden"),i.css("height",n+"px"))})}}var t=$("#welcome-panel"),n=$("#wp_welcome_panel-hide"),o;o=function(e){$.post(ajaxurl,{action:"update-welcome-panel",visible:e,welcomepanelnonce:$("#welcomepanelnonce").val()})},t.hasClass("hidden")&&n.prop("checked")&&t.removeClass("hidden"),$(".welcome-panel-close, .welcome-panel-dismiss a",t).click(function(e){e.preventDefault(),t.addClass("hidden"),o(0),$("#wp_welcome_panel-hide").prop("checked",!1)}),n.click(function(){t.toggleClass("hidden",!this.checked),o(this.checked?1:0)}),ajaxWidgets=["dashboard_primary"],ajaxPopulateWidgets=function(e){function t(e,t){var n,o=$("#"+t+" div.inside:visible").find(".widget-loading");o.length&&(n=o.parent(),setTimeout(function(){n.load(ajaxurl+"?action=dashboard-widgets&widget="+t+"&pagenow="+pagenow,"",function(){n.hide().slideDown("normal",function(){$(this).css("display","")})})},500*e))}e?(e=e.toString(),-1!==$.inArray(e,ajaxWidgets)&&t(0,e)):$.each(ajaxWidgets,t)},ajaxPopulateWidgets(),postboxes.add_postbox_toggles(pagenow,{pbshow:ajaxPopulateWidgets}),quickPressLoad=function(){var t=$("#quickpost-action"),n;$('#quick-press .submit input[type="submit"], #quick-press .submit input[type="reset"]').prop("disabled",!1),n=$("#quick-press").submit(function(e){function t(){var e=$(".drafts ul li").first();e.css("background","#fffbe5"),setTimeout(function(){e.css("background","none")},1e3)}e.preventDefault(),$("#dashboard_quick_press #publishing-action .spinner").show(),$('#quick-press .submit input[type="submit"], #quick-press .submit input[type="reset"]').prop("disabled",!0),$.post(n.attr("action"),n.serializeArray(),function(e){$("#dashboard_quick_press .inside").html(e),$("#quick-press").removeClass("initial-form"),quickPressLoad(),t(),$("#title").focus()})}),$("#publish").click(function(){t.val("post-quickpress-publish")}),$("#title, #tags-input, #content").each(function(){var e=$(this),t=$("#"+this.id+"-prompt-text");""===this.value&&t.removeClass("screen-reader-text"),t.click(function(){$(this).addClass("screen-reader-text"),e.focus()}),e.blur(function(){""===this.value&&t.removeClass("screen-reader-text")}),e.focus(function(){t.addClass("screen-reader-text")})}),$("#quick-press").on("click focusin",function(){wpActiveEditor="content"}),e()},quickPressLoad(),$(".meta-box-sortables").sortable("option","containment","#wpwrap")}),jQuery(function($){"use strict";var e=window.communityEventsData||{},t;t=window.wp.communityEvents={initialized:!1,model:null,init:function(){if(!t.initialized){var n=$("#community-events");$(".community-events-errors").attr("aria-hidden","true").removeClass("hide-if-js"),n.on("click",".community-events-toggle-location, .community-events-cancel",t.toggleLocationForm),n.on("submit",".community-events-form",function(e){var n=$.trim($("#community-events-location").val());e.preventDefault(),n&&t.getEvents({location:n})}),e&&e.cache&&e.cache.location&&e.cache.events?t.renderEventsTemplate(e.cache,"app"):t.getEvents(),t.initialized=!0}},toggleLocationForm:function(e){var t=$(".community-events-toggle-location"),n=$(".community-events-cancel"),o=$(".community-events-form"),i=$();"object"==typeof e&&(i=$(e.target),e="true"==t.attr("aria-expanded")?"hide":"show"),"hide"===e?(t.attr("aria-expanded","false"),n.attr("aria-expanded","false"),o.attr("aria-hidden","true"),i.hasClass("community-events-cancel")&&t.focus()):(t.attr("aria-expanded","true"),n.attr("aria-expanded","true"),o.attr("aria-hidden","false"))},getEvents:function(t){var n,o=this,i=$(".community-events-form").children(".spinner");t=t||{},t._wpnonce=e.nonce,t.timezone=window.Intl?window.Intl.DateTimeFormat().resolvedOptions().timeZone:"",n=t.location?"user":"app",i.addClass("is-active"),wp.ajax.post("get-community-events",t).always(function(){i.removeClass("is-active")}).done(function(e){"no_location_available"===e.error&&(t.location?e.unknownCity=t.location:delete e.error),o.renderEventsTemplate(e,n)}).fail(function(){o.renderEventsTemplate({location:!1,error:!0},n)})},renderEventsTemplate:function(n,o){var i,a,s=/%(?:\d\$)?s/g,c=$(".community-events-toggle-location"),r=$("#community-events-location-message"),l=$(".community-events-results");a={".community-events":!0,".community-events-loading":!1,".community-events-errors":!1,".community-events-error-occurred":!1,".community-events-could-not-locate":!1,"#community-events-location-message":!1,".community-events-toggle-location":!1,".community-events-results":!1},n.location.ip?(r.text(e.l10n.attend_event_near_generic),n.events.length?(i=wp.template("community-events-event-list"),l.html(i(n))):(i=wp.template("community-events-no-upcoming-events"),l.html(i(n))),a["#community-events-location-message"]=!0,a[".community-events-toggle-location"]=!0,a[".community-events-results"]=!0):n.location.description?(i=wp.template("community-events-attend-event-near"),r.html(i(n)),n.events.length?(i=wp.template("community-events-event-list"),l.html(i(n))):(i=wp.template("community-events-no-upcoming-events"),l.html(i(n))),"user"===o&&wp.a11y.speak(e.l10n.city_updated.replace(s,n.location.description),"assertive"),a["#community-events-location-message"]=!0,a[".community-events-toggle-location"]=!0,a[".community-events-results"]=!0):n.unknownCity?(i=wp.template("community-events-could-not-locate"),$(".community-events-could-not-locate").html(i(n)),wp.a11y.speak(e.l10n.could_not_locate_city.replace(s,n.unknownCity)),a[".community-events-errors"]=!0,a[".community-events-could-not-locate"]=!0):n.error&&"user"===o?(wp.a11y.speak(e.l10n.error_occurred_please_try_again),a[".community-events-errors"]=!0,a[".community-events-error-occurred"]=!0):(r.text(e.l10n.enter_closest_city),a["#community-events-location-message"]=!0,a[".community-events-toggle-location"]=!0),_.each(a,function(e,t){$(t).attr("aria-hidden",!e)}),c.attr("aria-expanded",a[".community-events-toggle-location"]),n.location&&(n.location.ip||n.location.latitude)?(t.toggleLocationForm("hide"),"user"===o&&c.focus()):t.toggleLocationForm("show")}},$("#dashboard_primary").is(":visible")?t.init():$(document).on("postbox-toggled",function(e,n){var o=$(n);"dashboard_primary"===o.attr("id")&&o.is(":visible")&&t.init()})});