!function(e,t,n){"use strict";function i(e){return"nav_menu_item["+e+"]"}function a(t){return t=t||"",t=n("<div>").text(t).html(),(t=n.trim(t))||e.Menus.data.l10n.unnamed}wpNavMenu.originalInit=wpNavMenu.init,wpNavMenu.options.menuItemDepthPerLevel=20,wpNavMenu.options.sortableItems="> .customize-control-nav_menu_item",wpNavMenu.options.targetTolerance=10,wpNavMenu.init=function(){this.jQueryExtensions()},e.Menus=e.Menus||{},e.Menus.data={itemTypes:[],l10n:{},settingTransport:"refresh",phpIntMax:0,defaultSettingValues:{nav_menu:{},nav_menu_item:{}},locationSlugMappedToName:{}},"undefined"!=typeof _wpCustomizeNavMenusSettings&&n.extend(e.Menus.data,_wpCustomizeNavMenusSettings),e.Menus.generatePlaceholderAutoIncrementId=function(){return-Math.ceil(e.Menus.data.phpIntMax*Math.random())},e.Menus.AvailableItemModel=Backbone.Model.extend(n.extend({id:null},e.Menus.data.defaultSettingValues.nav_menu_item)),e.Menus.AvailableItemCollection=Backbone.Collection.extend({model:e.Menus.AvailableItemModel,sort_key:"order",comparator:function(e){return-e.get(this.sort_key)},sortByField:function(e){this.sort_key=e,this.sort()}}),e.Menus.availableMenuItems=new e.Menus.AvailableItemCollection(e.Menus.data.availableMenuItems),e.Menus.insertAutoDraftPost=function i(a){var o,s=n.Deferred();return(o=t.ajax.post("customize-nav-menus-insert-auto-draft",{"customize-menus-nonce":e.settings.nonce["customize-menus"],wp_customize:"on",customize_changeset_uuid:e.settings.changeset.uuid,params:a})).done(function(t){t.post_id&&(e("nav_menus_created_posts").set(e("nav_menus_created_posts").get().concat([t.post_id])),"page"===a.post_type&&(e.section.has("static_front_page")&&e.section("static_front_page").activate(),e.control.each(function(e){var n;"dropdown-pages"===e.params.type&&(n=e.container.find('select[name^="_customize-dropdown-pages-"]')).append(new Option(a.post_title,t.post_id))})),s.resolve(t))}),o.fail(function(e){var t=e||"";void 0!==e.message&&(t=e.message),console.error(t),s.rejectWith(t)}),s.promise()},e.Menus.AvailableMenuItemsPanelView=t.Backbone.View.extend({el:"#available-menu-items",events:{"input #menu-items-search":"debounceSearch","keyup #menu-items-search":"debounceSearch","focus .menu-item-tpl":"focus","click .menu-item-tpl":"_submit","click #custom-menu-item-submit":"_submitLink","keypress #custom-menu-item-name":"_submitLink","click .new-content-item .add-content":"_submitNew","keypress .create-item-input":"_submitNew",keydown:"keyboardAccessible"},selected:null,currentMenuControl:null,debounceSearch:null,$search:null,$clearResults:null,searchTerm:"",rendered:!1,pages:{},sectionContent:"",loading:!1,addingNew:!1,initialize:function(){var t=this;e.panel.has("nav_menus")&&(this.$search=n("#menu-items-search"),this.$clearResults=this.$el.find(".clear-results"),this.sectionContent=this.$el.find(".available-menu-items-list"),this.debounceSearch=_.debounce(t.search,500),_.bindAll(this,"close"),n("#customize-controls, .customize-section-back").on("click keydown",function(e){var i=n(e.target).is(".item-delete, .item-delete *"),a=n(e.target).is(".add-new-menu-item, .add-new-menu-item *");!n("body").hasClass("adding-menu-items")||i||a||t.close()}),this.$clearResults.on("click",function(){t.$search.val("").focus().trigger("keyup")}),this.$el.on("input","#custom-menu-item-name.invalid, #custom-menu-item-url.invalid",function(){n(this).removeClass("invalid")}),e.panel("nav_menus").container.bind("expanded",function(){t.rendered||(t.initList(),t.rendered=!0)}),this.sectionContent.scroll(function(){var e=t.$el.find(".accordion-section.open .available-menu-items-list").prop("scrollHeight"),i=t.$el.find(".accordion-section.open").height();if(!t.loading&&n(this).scrollTop()>.75*e-i){var a=n(this).data("type"),o=n(this).data("object");"search"===a?t.searchTerm&&t.doSearch(t.pages.search):t.loadItems([{type:a,object:o}])}}),e.previewer.bind("url",this.close),t.delegateEvents())},search:function(e){var t=n("#available-menu-items-search"),i=n("#available-menu-items .accordion-section").not(t);e&&this.searchTerm!==e.target.value&&(""===e.target.value||t.hasClass("open")?""===e.target.value&&(t.removeClass("open"),i.show(),this.$clearResults.removeClass("is-visible")):(i.fadeOut(100),t.find(".accordion-section-content").slideDown("fast"),t.addClass("open"),this.$clearResults.addClass("is-visible")),this.searchTerm=e.target.value,this.pages.search=1,this.doSearch(1))},doSearch:function(i){var a=this,o,s=n("#available-menu-items-search"),r=s.find(".accordion-section-content"),u=t.template("available-menu-item");if(a.currentRequest&&a.currentRequest.abort(),!(i<0)){if(i>1)s.addClass("loading-more"),r.attr("aria-busy","true"),t.a11y.speak(e.Menus.data.l10n.itemsLoadingMore);else if(""===a.searchTerm)return r.html(""),void t.a11y.speak("");s.addClass("loading"),a.loading=!0,o=e.previewer.query({excludeCustomizedSaved:!0}),_.extend(o,{"customize-menus-nonce":e.settings.nonce["customize-menus"],wp_customize:"on",search:a.searchTerm,page:i}),a.currentRequest=t.ajax.post("search-available-menu-items-customizer",o),a.currentRequest.done(function(n){var o;1===i&&r.empty(),s.removeClass("loading loading-more"),r.attr("aria-busy","false"),s.addClass("open"),a.loading=!1,o=new e.Menus.AvailableItemCollection(n.items),a.collection.add(o.models),o.each(function(e){r.append(u(e.attributes))}),20>o.length?a.pages.search=-1:a.pages.search=a.pages.search+1,o&&i>1?t.a11y.speak(e.Menus.data.l10n.itemsFoundMore.replace("%d",o.length)):o&&1===i&&t.a11y.speak(e.Menus.data.l10n.itemsFound.replace("%d",o.length))}),a.currentRequest.fail(function(e){e.message&&(r.empty().append(n('<li class="nothing-found"></li>').text(e.message)),t.a11y.speak(e.message)),a.pages.search=-1}),a.currentRequest.always(function(){s.removeClass("loading loading-more"),r.attr("aria-busy","false"),a.loading=!1,a.currentRequest=null})}},initList:function(){var t=this;_.each(e.Menus.data.itemTypes,function(e){t.pages[e.type+":"+e.object]=0}),t.loadItems(e.Menus.data.itemTypes)},loadItems:function(i,a){var o=this,s,r=[],u,d,c,l={};c=t.template("available-menu-item"),s=_.isString(i)&&_.isString(a)?[{type:i,object:a}]:i,_.each(s,function(e){var t,i=e.type+":"+e.object;-1!==o.pages[i]&&((t=n("#available-menu-items-"+e.type+"-"+e.object)).find(".accordion-section-title").addClass("loading"),l[i]=t,r.push({object:e.object,type:e.type,page:o.pages[i]}))}),0!==r.length&&(o.loading=!0,u=e.previewer.query({excludeCustomizedSaved:!0}),_.extend(u,{"customize-menus-nonce":e.settings.nonce["customize-menus"],wp_customize:"on",item_types:r}),(d=t.ajax.post("load-available-menu-items-customizer",u)).done(function(t){var n;_.each(t.items,function(t,i){if(0===t.length)return 0===o.pages[i]&&l[i].find(".accordion-section-title").addClass("cannot-expand").removeClass("loading").find(".accordion-section-title > button").prop("tabIndex",-1),void(o.pages[i]=-1);"post_type:page"!==i||l[i].hasClass("open")||l[i].find(".accordion-section-title > button").click(),t=new e.Menus.AvailableItemCollection(t),o.collection.add(t.models),n=l[i].find(".available-menu-items-list"),t.each(function(e){n.append(c(e.attributes))}),o.pages[i]+=1})}),d.fail(function(e){"undefined"!=typeof console&&console.error&&console.error(e)}),d.always(function(){_.each(l,function(e){e.find(".accordion-section-title").removeClass("loading")}),o.loading=!1}))},itemSectionHeight:function(){var e,t,n,i,a;n=window.innerHeight,e=this.$el.find(".accordion-section:not( #available-menu-items-search ) .accordion-section-content"),t=this.$el.find('.accordion-section:not( #available-menu-items-search ) .available-menu-items-list:not(":only-child")'),120<(a=n-(i=46*(1+e.length)+14))&&290>a&&(e.css("max-height",a),t.css("max-height",a-60))},select:function(e){this.selected=n(e),this.selected.siblings(".menu-item-tpl").removeClass("selected"),this.selected.addClass("selected")},focus:function(e){this.select(n(e.currentTarget))},_submit:function(e){"keypress"===e.type&&13!==e.which&&32!==e.which||this.submit(n(e.currentTarget))},submit:function(e){var t,i;e||(e=this.selected),e&&this.currentMenuControl&&(this.select(e),t=n(this.selected).data("menu-item-id"),(i=this.collection.findWhere({id:t}))&&(this.currentMenuControl.addItemToMenu(i.attributes),n(e).find(".menu-item-handle").addClass("item-added")))},_submitLink:function(e){"keypress"===e.type&&13!==e.which||this.submitLink()},submitLink:function(){var t,i=n("#custom-menu-item-name"),a=n("#custom-menu-item-url"),o;this.currentMenuControl&&(o=/^((\w+:)?\/\/\w.*|\w+:(?!\/\/$)|\/|\?|#)/,""!==i.val()?o.test(a.val())?(t={title:i.val(),url:a.val(),type:"custom",type_label:e.Menus.data.l10n.custom_label,object:"custom"},this.currentMenuControl.addItemToMenu(t),a.val("http://"),i.val("")):a.addClass("invalid"):i.addClass("invalid"))},_submitNew:function(e){var t;"keypress"===e.type&&13!==e.which||this.addingNew||(t=n(e.target).closest(".accordion-section"),this.submitNew(t))},submitNew:function(i){var a=this,o=i.find(".create-item-input"),s=o.val(),r=i.find(".available-menu-items-list"),u=r.data("type"),d=r.data("object"),c=r.data("type_label"),l;if(this.currentMenuControl&&"post_type"===u){if(""===n.trim(o.val()))return o.addClass("invalid"),void o.focus();o.removeClass("invalid"),i.find(".accordion-section-title").addClass("loading"),a.addingNew=!0,o.attr("disabled","disabled"),(l=e.Menus.insertAutoDraftPost({post_title:s,post_type:d})).done(function(s){var r,l,m;r=new e.Menus.AvailableItemModel({id:"post-"+s.post_id,title:o.val(),type:u,type_label:c,object:d,object_id:s.post_id,url:s.url}),a.currentMenuControl.addItemToMenu(r.attributes),e.Menus.availableMenuItemsPanel.collection.add(r),l=i.find(".available-menu-items-list"),(m=n(t.template("available-menu-item")(r.attributes))).find(".menu-item-handle:first").addClass("item-added"),l.prepend(m),l.scrollTop(),o.val("").removeAttr("disabled"),a.addingNew=!1,i.find(".accordion-section-title").removeClass("loading")})}},open:function(t){var i=this,a;this.currentMenuControl=t,this.itemSectionHeight(),e.section.has("publish_settings")&&e.section("publish_settings").collapse(),n("body").addClass("adding-menu-items"),a=function(){i.close(),n(this).off("click",a)},n("#customize-preview").on("click",a),_(this.currentMenuControl.getMenuItemControls()).each(function(e){e.collapseForm()}),this.$el.find(".selected").removeClass("selected"),this.$search.focus()},close:function(e){(e=e||{}).returnFocus&&this.currentMenuControl&&this.currentMenuControl.container.find(".add-new-menu-item").focus(),this.currentMenuControl=null,this.selected=null,n("body").removeClass("adding-menu-items"),n("#available-menu-items .menu-item-handle.item-added").removeClass("item-added"),this.$search.val("").trigger("keyup")},keyboardAccessible:function(e){var t=13===e.which,i=27===e.which,a=9===e.which&&e.shiftKey,o=n(e.target).is(this.$search);t&&!this.$search.val()||(o&&a?(this.currentMenuControl.container.find(".add-new-menu-item").focus(),e.preventDefault()):i&&this.close({returnFocus:!0}))}}),e.Menus.MenusPanel=e.Panel.extend({attachEvents:function(){e.Panel.prototype.attachEvents.call(this);var t=this,i=this.container.find(".panel-meta"),a=i.find(".customize-help-toggle"),o=i.find(".customize-panel-description"),s=n("#screen-options-wrap"),r=i.find(".customize-screen-options-toggle");r.on("click keydown",function(t){if(!e.utils.isKeydownButNotEnterEvent(t))return t.preventDefault(),o.not(":hidden")&&(o.slideUp("fast"),a.attr("aria-expanded","false")),"true"===r.attr("aria-expanded")?(r.attr("aria-expanded","false"),i.removeClass("open"),i.removeClass("active-menu-screen-options"),s.slideUp("fast")):(r.attr("aria-expanded","true"),i.addClass("open"),i.addClass("active-menu-screen-options"),s.slideDown("fast")),!1}),a.on("click keydown",function(t){e.utils.isKeydownButNotEnterEvent(t)||(t.preventDefault(),"true"===r.attr("aria-expanded")&&(r.attr("aria-expanded","false"),a.attr("aria-expanded","true"),i.addClass("open"),i.removeClass("active-menu-screen-options"),s.slideUp("fast"),o.slideDown("fast")))})},ready:function(){var n=this;n.container.find(".hide-column-tog").click(function(){n.saveManageColumnsState()}),e.section("menu_locations",function(n){n.headContainer.prepend(t.template("nav-menu-locations-header")(e.Menus.data))})},saveManageColumnsState:_.debounce(function(){var e=this;e._updateHiddenColumnsRequest&&e._updateHiddenColumnsRequest.abort(),e._updateHiddenColumnsRequest=t.ajax.post("hidden-columns",{hidden:e.hidden(),screenoptionnonce:n("#screenoptionnonce").val(),page:"nav-menus"}),e._updateHiddenColumnsRequest.always(function(){e._updateHiddenColumnsRequest=null})},2e3),checked:function(){},unchecked:function(){},hidden:function(){return n(".hide-column-tog").not(":checked").map(function(){var e=this.id;return e.substring(0,e.length-5)}).get().join(",")}}),e.Menus.MenuSection=e.Section.extend({initialize:function(t,i){var a=this;e.Section.prototype.initialize.call(this,t,i),this.deferred.initSortables=n.Deferred()},ready:function(){var t=this,i,a;if(void 0===t.params.menu_id)throw new Error("params.menu_id was not defined");t.active.validate=function(){return!!e.has(t.id)&&!!e(t.id).get()},t.populateControls(),t.navMenuLocationSettings={},t.assignedLocations=new e.Value([]),e.each(function(e,n){var i=n.match(/^nav_menu_locations\[(.+?)]/);i&&(t.navMenuLocationSettings[i[1]]=e,e.bind(function(){t.refreshAssignedLocations()}))}),t.assignedLocations.bind(function(e){t.updateAssignedLocationsInSectionTitle(e)}),t.refreshAssignedLocations(),e.bind("pane-contents-reflowed",function(){t.contentContainer.parent().length&&(t.container.find(".menu-item .menu-item-reorder-nav button").attr({tabindex:"0","aria-hidden":"false"}),t.container.find(".menu-item.move-up-disabled .menus-move-up").attr({tabindex:"-1","aria-hidden":"true"}),t.container.find(".menu-item.move-down-disabled .menus-move-down").attr({tabindex:"-1","aria-hidden":"true"}),t.container.find(".menu-item.move-left-disabled .menus-move-left").attr({tabindex:"-1","aria-hidden":"true"}),t.container.find(".menu-item.move-right-disabled .menus-move-right").attr({tabindex:"-1","aria-hidden":"true"}))}),a=function(){var e="field-"+n(this).val()+"-active";t.contentContainer.toggleClass(e,n(this).prop("checked"))},(i=e.panel("nav_menus").contentContainer.find(".metabox-prefs:first").find(".hide-column-tog")).each(a),i.on("click",a)},populateControls:function(){var t=this,n,i,a,o,s,r,u,d,c;n=t.id+"[name]",(r=e.control(n))||(r=new e.controlConstructor.nav_menu_name(n,{type:"nav_menu_name",label:e.Menus.data.l10n.menuNameLabel,section:t.id,priority:0,settings:{default:t.id}}),e.control.add(r),r.active.set(!0)),(s=e.control(t.id))||(s=new e.controlConstructor.nav_menu(t.id,{type:"nav_menu",section:t.id,priority:998,settings:{default:t.id},menu_id:t.params.menu_id}),e.control.add(s),s.active.set(!0)),i=t.id+"[locations]",(u=e.control(i))||(u=new e.controlConstructor.nav_menu_locations(i,{section:t.id,priority:999,settings:{default:t.id},menu_id:t.params.menu_id}),e.control.add(u.id,u),s.active.set(!0)),a=t.id+"[auto_add]",(d=e.control(a))||(d=new e.controlConstructor.nav_menu_auto_add(a,{type:"nav_menu_auto_add",label:"",section:t.id,priority:1e3,settings:{default:t.id}}),e.control.add(d),d.active.set(!0)),o=t.id+"[delete]",(c=e.control(o))||(c=new e.Control(o,{section:t.id,priority:1001,templateId:"nav-menu-delete-button"}),e.control.add(c.id,c),c.active.set(!0),c.deferred.embedded.done(function(){c.container.find("button").on("click",function(){var n=t.params.menu_id,i;e.Menus.getMenuControl(n).setting.set(!1)})}))},refreshAssignedLocations:function(){var e=this,t=this.params.menu_id,n=[];_.each(this.navMenuLocationSettings,function(e,i){e()===t&&n.push(i)}),this.assignedLocations.set(n)},updateAssignedLocationsInSectionTitle:function(t){var i=this,a;(a=this.container.find(".accordion-section-title:first")).find(".menu-in-location").remove(),_.each(t,function(t){var i,o;i=n('<span class="menu-in-location"></span>'),o=e.Menus.data.locationSlugMappedToName[t],i.text(e.Menus.data.l10n.menuLocation.replace("%s",o)),a.append(i)}),this.container.toggleClass("assigned-to-menu-location",0!==t.length)},onChangeExpanded:function(t,i){var a=this,o;t&&(wpNavMenu.menuList=a.contentContainer,wpNavMenu.targetList=wpNavMenu.menuList,n("#menu-to-edit").removeAttr("id"),wpNavMenu.menuList.attr("id","menu-to-edit").addClass("menu"),_.each(e.section(a.id).controls(),function(e){"nav_menu_item"===e.params.type&&e.actuallyEmbed()}),i.completeCallback&&(o=i.completeCallback),i.completeCallback=function(){"resolved"!==a.deferred.initSortables.state()&&(wpNavMenu.initSortables(),a.deferred.initSortables.resolve(wpNavMenu.menuList),e.control("nav_menu["+String(a.params.menu_id)+"]").reflowMenuItems()),_.isFunction(o)&&o()}),e.Section.prototype.onChangeExpanded.call(a,t,i)},highlightNewItemButton:function(){e.utils.highlightButton(this.contentContainer.find(".add-new-menu-item"),{delay:2e3})}}),e.Menus.createNavMenu=function t(i){var o,s,r;return s=e.Menus.generatePlaceholderAutoIncrementId(),o="nav_menu["+String(s)+"]",(r=e.create(o,o,{},{type:"nav_menu",transport:e.Menus.data.settingTransport,previewer:e.previewer})).set(n.extend({},e.Menus.data.defaultSettingValues.nav_menu,{name:i||""})),e.section.add(new e.Menus.MenuSection(o,{panel:"nav_menus",title:a(i),customizeAction:e.Menus.data.l10n.customizingMenus,priority:10,menu_id:s}))},e.Menus.NewMenuSection=e.Section.extend({attachEvents:function(){function n(){var t=0;return e.each(function(e){d.test(e.id)&&!1!==e.get()&&(t+=1)}),t}function i(){r.find(".add-new-menu-notice").prop("hidden",n()>0)}function a(e){d.test(e.id)&&(e.bind(i),i())}function o(e){d.test(e.id)&&(e.unbind(i),i())}var s=this,r=s.container,u=s.contentContainer,d=/^nav_menu\[/;s.headContainer.find(".accordion-section-title").replaceWith(t.template("nav-menu-create-menu-section-title")),r.on("click",".customize-add-menu-button",function(){s.expand()}),u.on("keydown",".menu-name-field",function(e){13===e.which&&s.submit()}),u.on("click","#customize-new-menu-submit",function(e){s.submit(),e.stopPropagation(),e.preventDefault()}),e.each(a),e.bind("add",a),e.bind("removed",o),i(),e.Section.prototype.attachEvents.apply(s,arguments)},ready:function(){this.populateControls()},populateControls:function(){var t=this,n,i,a,o,s,r;n=this.id+"[name]",(o=e.control(n))||(o=new e.controlConstructor.nav_menu_name(n,{label:e.Menus.data.l10n.menuNameLabel,description:e.Menus.data.l10n.newMenuNameDescription,section:this.id,priority:0}),e.control.add(o.id,o),o.active.set(!0)),i=this.id+"[locations]",(s=e.control(i))||(s=new e.controlConstructor.nav_menu_locations(i,{section:this.id,priority:1,menu_id:"",isCreating:!0}),e.control.add(i,s),s.active.set(!0)),a=this.id+"[submit]",(r=e.control(a))||(r=new e.Control(a,{section:this.id,priority:1,templateId:"nav-menu-submit-new-button"}),e.control.add(a,r),r.active.set(!0))},submit:function(){var i=this,a=this.contentContainer,o=a.find(".menu-name-field").first(),s=o.val(),r;if(!s)return o.addClass("invalid"),void o.focus();r=e.Menus.createNavMenu(s),o.val(""),o.removeClass("invalid"),a.find(".assigned-menu-location input[type=checkbox]").each(function(){var t=n(this),i;t.prop("checked")&&((i=e("nav_menu_locations["+t.data("location-id")+"]")).set(r.params.menu_id),t.prop("checked",!1))}),t.a11y.speak(e.Menus.data.l10n.menuAdded),r.focus({completeCallback:function(){r.highlightNewItemButton()}})},selectDefaultLocation:function(t){var n=e.control(this.id+"[locations]"),i={};null!==t&&(i[t]=!0),n.setSelections(i)}}),e.Menus.MenuLocationControl=e.Control.extend({initialize:function(t,n){var i=this,a=t.match(/^nav_menu_locations\[(.+?)]/);this.themeLocation=a[1],e.Control.prototype.initialize.call(this,t,n)},ready:function(){var t=this,n=/^nav_menu\[(-?\d+)]/;t.setting.validate=function(e){return""===e?0:parseInt(e,10)},t.container.find(".create-menu").on("click",function(){var t=e.section("add_menu");t.selectDefaultLocation(this.dataset.locationId),t.focus()}),t.container.find(".edit-menu").on("click",function(){var n=t.setting();e.section("nav_menu["+n+"]").focus()}),t.setting.bind("change",function(){var e=0!==t.setting();t.container.find(".create-menu").toggleClass("hidden",e),t.container.find(".edit-menu").toggleClass("hidden",!e)}),e.bind("add",function(e){var i,o,s=e.id.match(n);s&&!1!==e()&&(o=s[1],i=new Option(a(e().name),o),t.container.find("select").append(i))}),e.bind("remove",function(e){var i,a=e.id.match(n);a&&(i=parseInt(a[1],10),t.setting()===i&&t.setting.set(""),t.container.find("option[value="+i+"]").remove())}),e.bind("change",function(e){var i,o=e.id.match(n);o&&(i=parseInt(o[1],10),!1===e()?(t.setting()===i&&t.setting.set(""),t.container.find("option[value="+i+"]").remove()):t.container.find("option[value="+i+"]").text(a(e().name)))})}}),e.Menus.MenuItemControl=e.Control.extend({initialize:function(t,i){var a=this;a.expanded=new e.Value(!1),a.expandedArgumentsQueue=[],a.expanded.bind(function(e){var t=a.expandedArgumentsQueue.shift();t=n.extend({},a.defaultExpandedArguments,t),a.onChangeExpanded(e,t)}),e.Control.prototype.initialize.call(a,t,i),a.active.validate=function(){var t,n=e.section(a.section());return t=!!n&&n.active()}},embed:function(){var t=this,n=this.section(),i;n&&((i=e.section(n))&&i.expanded()||e.settings.autofocus.control===this.id)&&this.actuallyEmbed()},actuallyEmbed:function(){var e=this;"resolved"!==this.deferred.embedded.state()&&(this.renderContent(),this.deferred.embedded.resolve())},ready:function(){if(void 0===this.params.menu_item_id)throw new Error("params.menu_item_id was not defined");this._setupControlToggle(),this._setupReorderUI(),this._setupUpdateUI(),this._setupRemoveUI(),this._setupLinksUI(),this._setupTitleUI()},_setupControlToggle:function(){var t=this;this.container.find(".menu-item-handle").on("click",function(i){i.preventDefault(),i.stopPropagation();var a=t.getMenuControl(),o=n(i.target).is(".item-delete, .item-delete *"),s=n(i.target).is(".add-new-menu-item, .add-new-menu-item *");!n("body").hasClass("adding-menu-items")||o||s||e.Menus.availableMenuItemsPanel.close(),a.isReordering||a.isSorting||t.toggleForm()})},_setupReorderUI:function(){var e=this,i,a;i=t.template("menu-item-reorder-nav"),e.container.find(".item-controls").after(i),(a=e.container.find(".menu-item-reorder-nav")).find(".menus-move-up, .menus-move-down, .menus-move-left, .menus-move-right").on("click",function(){var t=n(this);t.focus();var i=t.is(".menus-move-up"),a=t.is(".menus-move-down"),o=t.is(".menus-move-left"),s=t.is(".menus-move-right");i?e.moveUp():a?e.moveDown():o?e.moveLeft():s&&e.moveRight(),t.focus()})},_setupUpdateUI:function(){var t=this,n=t.setting(),i;t.elements={},t.elements.url=new e.Element(t.container.find(".edit-menu-item-url")),t.elements.title=new e.Element(t.container.find(".edit-menu-item-title")),t.elements.attr_title=new e.Element(t.container.find(".edit-menu-item-attr-title")),t.elements.target=new e.Element(t.container.find(".edit-menu-item-target")),t.elements.classes=new e.Element(t.container.find(".edit-menu-item-classes")),t.elements.xfn=new e.Element(t.container.find(".edit-menu-item-xfn")),t.elements.description=new e.Element(t.container.find(".edit-menu-item-description")),_.each(t.elements,function(e,i){e.bind(function(n){e.element.is("input[type=checkbox]")&&(n=n?e.element.val():"");var a=t.setting();a&&a[i]!==n&&((a=_.clone(a))[i]=n,t.setting.set(a))}),n&&("classes"!==i&&"xfn"!==i||!_.isArray(n[i])?e.set(n[i]):e.set(n[i].join(" ")))}),t.setting.bind(function(n,i){var a=t.params.menu_item_id,o=[],s=[],r;!1===n?(r=e.control("nav_menu["+String(i.nav_menu_term_id)+"]"),t.container.remove(),_.each(r.getMenuItemControls(),function(e){i.menu_item_parent===e.setting().menu_item_parent&&e.setting().position>i.position?o.push(e):e.setting().menu_item_parent===a&&s.push(e)}),_.each(o,function(e){var t=_.clone(e.setting());t.position+=s.length,e.setting.set(t)}),_.each(s,function(e,t){var n=_.clone(e.setting());n.position=i.position+t,n.menu_item_parent=i.menu_item_parent,e.setting.set(n)}),r.debouncedReflowMenuItems()):(_.each(n,function(e,i){t.elements[i]&&t.elements[i].set(n[i])}),t.container.find(".menu-item-data-parent-id").val(n.menu_item_parent),n.position===i.position&&n.menu_item_parent===i.menu_item_parent||t.getMenuControl().debouncedReflowMenuItems())}),i=function(){t.elements.url.element.toggleClass("invalid",t.setting.notifications.has("invalid_url"))},t.setting.notifications.bind("add",i),t.setting.notifications.bind("removed",i)},_setupRemoveUI:function(){var i=this,a;(a=i.container.find(".item-delete")).on("click",function(){var a=!0,o,s,r;n("body").hasClass("adding-menu-items")||(a=!1),s=i.container.nextAll(".customize-control-nav_menu_item:visible").first(),r=i.container.prevAll(".customize-control-nav_menu_item:visible").first(),o=s.length?s.find(!1===a?".item-edit":".item-delete").first():r.length?r.find(!1===a?".item-edit":".item-delete").first():i.container.nextAll(".customize-control-nav_menu").find(".add-new-menu-item").first(),i.container.slideUp(function(){i.setting.set(!1),t.a11y.speak(e.Menus.data.l10n.itemDeleted),o.focus()}),i.setting.set(!1)})},_setupLinksUI:function(){var t;(t=this.container.find("a.original-link")).on("click",function(t){t.preventDefault(),e.previewer.previewUrl(t.target.toString())})},_setupTitleUI:function(){var t=this,i;this.container.find(".edit-menu-item-title").on("blur",function(){n(this).val(n.trim(n(this).val()))}),i=this.container.find(".menu-item-title"),this.setting.bind(function(t){var a,o;t&&(o=(a=n.trim(t.title))||t.original_title||e.Menus.data.l10n.untitled,t._invalid&&(o=e.Menus.data.l10n.invalidTitleTpl.replace("%s",o)),a||t.original_title?i.text(o).removeClass("no-title"):i.text(o).addClass("no-title"))})},getDepth:function(){var t=this,n=t.setting(),i=0;if(!n)return 0;for(;n&&n.menu_item_parent&&(i+=1,t=e.control("nav_menu_item["+n.menu_item_parent+"]"));)n=t.setting();return i},renderContent:function(){var t=this,n=this.setting(),i;this.params.title=n.title||"",this.params.depth=this.getDepth(),this.container.data("item-depth",this.params.depth),i=["menu-item","menu-item-depth-"+String(this.params.depth),"menu-item-"+n.object,"menu-item-edit-inactive"],n._invalid?(i.push("menu-item-invalid"),this.params.title=e.Menus.data.l10n.invalidTitleTpl.replace("%s",this.params.title)):"draft"===n.status&&(i.push("pending"),this.params.title=e.Menus.data.pendingTitleTpl.replace("%s",this.params.title)),this.params.el_classes=i.join(" "),this.params.item_type_label=n.type_label,this.params.item_type=n.type,this.params.url=n.url,this.params.target=n.target,this.params.attr_title=n.attr_title,this.params.classes=_.isArray(n.classes)?n.classes.join(" "):n.classes,this.params.attr_title=n.attr_title,this.params.xfn=n.xfn,this.params.description=n.description,this.params.parent=n.menu_item_parent,this.params.original_title=n.original_title||"",this.container.addClass(this.params.el_classes),e.Control.prototype.renderContent.call(this)},getMenuControl:function(){var t=this,n=this.setting();return n&&n.nav_menu_term_id?e.control("nav_menu["+n.nav_menu_term_id+"]"):null},expandControlSection:function(){var e=this.container.closest(".accordion-section");e.hasClass("open")||e.find(".accordion-section-title:first").trigger("click")},_toggleExpanded:e.Section.prototype._toggleExpanded,expand:e.Section.prototype.expand,expandForm:function(e){this.expand(e)},collapse:e.Section.prototype.collapse,collapseForm:function(e){this.collapse(e)},toggleForm:function(e,t){void 0===e&&(e=!this.expanded()),e?this.expand(t):this.collapse(t)},onChangeExpanded:function(t,n){var i=this,a,o,s;o=(a=this.container).find(".menu-item-settings:first"),void 0===t&&(t=!o.is(":visible")),o.is(":visible")!==t?t?(e.control.each(function(e){i.params.type===e.params.type&&i!==e&&e.collapseForm()}),s=function(){a.removeClass("menu-item-edit-inactive").addClass("menu-item-edit-active"),i.container.trigger("expanded"),n&&n.completeCallback&&n.completeCallback()},a.find(".item-edit").attr("aria-expanded","true"),o.slideDown("fast",s),i.container.trigger("expand")):(s=function(){a.addClass("menu-item-edit-inactive").removeClass("menu-item-edit-active"),i.container.trigger("collapsed"),n&&n.completeCallback&&n.completeCallback()},i.container.trigger("collapse"),a.find(".item-edit").attr("aria-expanded","false"),o.slideUp("fast",s)):n&&n.completeCallback&&n.completeCallback()},focus:function(t){var n=this,i=(t=t||{}).completeCallback,a;a=function(){n.expandControlSection(),t.completeCallback=function(){var e;(e=n.container.find(".menu-item-settings").find("input, select, textarea, button, object, a[href], [tabindex]").filter(":visible")).first().focus(),i&&i()},n.expandForm(t)},e.section.has(n.section())?e.section(n.section()).expand({completeCallback:a}):a()},moveUp:function(){this._changePosition(-1),t.a11y.speak(e.Menus.data.l10n.movedUp)},moveDown:function(){this._changePosition(1),t.a11y.speak(e.Menus.data.l10n.movedDown)},moveLeft:function(){this._changeDepth(-1),t.a11y.speak(e.Menus.data.l10n.movedLeft)},moveRight:function(){this._changeDepth(1),t.a11y.speak(e.Menus.data.l10n.movedRight)},_changePosition:function(e){var t=this,i,a=_.clone(this.setting()),o=[],s;if(1!==e&&-1!==e)throw new Error("Offset changes by 1 are only supported.");if(this.setting()){if(_(this.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===a.menu_item_parent&&o.push(e.setting)}),o.sort(function(e,t){return e().position-t().position}),-1===(s=_.indexOf(o,this.setting)))throw new Error("Expected setting to be among siblings.");0===s&&e<0||s===o.length-1&&e>0||((i=o[s+e])&&i.set(n.extend(_.clone(i()),{position:a.position})),a.position+=e,this.setting.set(a))}},_changeDepth:function(t){if(1!==t&&-1!==t)throw new Error("Offset changes by 1 are only supported.");var i=this,a=_.clone(i.setting()),o=[],s,r,u;if(_(i.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===a.menu_item_parent&&o.push(e)}),o.sort(function(e,t){return e.setting().position-t.setting().position}),-1===(s=_.indexOf(o,i)))throw new Error("Expected control to be among siblings.");if(-1===t){if(!a.menu_item_parent)return;u=e.control("nav_menu_item["+a.menu_item_parent+"]"),_(o).chain().slice(s).each(function(e,t){e.setting.set(n.extend({},e.setting(),{menu_item_parent:i.params.menu_item_id,position:t}))}),_(i.getMenuControl().getMenuItemControls()).each(function(e){var t,i;(i=e.setting().menu_item_parent===u.setting().menu_item_parent&&e.setting().position>u.setting().position)&&(t=_.clone(e.setting()),e.setting.set(n.extend(t,{position:t.position+1})))}),a.position=u.setting().position+1,a.menu_item_parent=u.setting().menu_item_parent,i.setting.set(a)}else if(1===t){if(0===s)return;r=o[s-1],a.menu_item_parent=r.params.menu_item_id,a.position=0,_(i.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===a.menu_item_parent&&(a.position=Math.max(a.position,e.setting().position))}),a.position+=1,i.setting.set(a)}}}),e.Menus.MenuNameControl=e.Control.extend({ready:function(){var t=this;if(t.setting){var n=t.setting();t.nameElement=new e.Element(t.container.find(".menu-name-field")),t.nameElement.bind(function(e){var n=t.setting();n&&n.name!==e&&((n=_.clone(n)).name=e,t.setting.set(n))}),n&&t.nameElement.set(n.name),t.setting.bind(function(e){e&&t.nameElement.set(e.name)})}}}),e.Menus.MenuLocationsControl=e.Control.extend({ready:function(){var t=this;t.container.find(".assigned-menu-location").each(function(){var i=n(this),o=i.find("input[type=checkbox]"),s=new e.Element(o),r=e("nav_menu_locations["+o.data("location-id")+"]"),u=""===t.params.menu_id,d=u?_.noop:function(e){s.set(e)},c=u?_.noop:function(e){r.set(e?t.params.menu_id:0)},l=function(t){var n=e("nav_menu["+String(t)+"]")
;t&&n&&n()?i.find(".theme-location-set").show().find("span").text(a(n().name)):i.find(".theme-location-set").hide()};d(r.get()===t.params.menu_id),o.on("change",function(){c(this.checked)}),r.bind(function(e){d(e===t.params.menu_id),l(e)}),l(r.get())})},setSelections:function(e){this.container.find(".menu-location").each(function(t,n){var i=n.dataset.locationId;n.checked=i in e&&e[i]})}}),e.Menus.MenuAutoAddControl=e.Control.extend({ready:function(){var t=this,n=t.setting();t.active.validate=function(){var n,i=e.section(t.section());return n=!!i&&i.active()},t.autoAddElement=new e.Element(t.container.find("input[type=checkbox].auto_add")),t.autoAddElement.bind(function(e){var n=t.setting();n&&n.name!==e&&((n=_.clone(n)).auto_add=e,t.setting.set(n))}),n&&t.autoAddElement.set(n.auto_add),t.setting.bind(function(e){e&&t.autoAddElement.set(e.auto_add)})}}),e.Menus.MenuControl=e.Control.extend({ready:function(){var t=this,i=e.section(t.section()),o=t.params.menu_id,s=t.setting(),r,u,d;if(void 0===this.params.menu_id)throw new Error("params.menu_id was not defined");t.active.validate=function(){var e;return e=!!i&&i.active()},t.$controlSection=i.headContainer,t.$sectionContent=t.container.closest(".accordion-section-content"),this._setupModel(),e.section(t.section(),function(e){e.deferred.initSortables.done(function(e){t._setupSortable(e)})}),this._setupAddition(),this._setupTitle(),s&&(r=a(s.name),e.control.each(function(t){t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base&&(t.container.find(".nav-menu-widget-form-controls:first").show(),t.container.find(".nav-menu-widget-no-menus-message:first").hide(),0===(d=t.container.find("select")).find("option[value="+String(o)+"]").length&&d.append(new Option(r,o)))}),(u=n("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )")).find(".nav-menu-widget-form-controls:first").show(),u.find(".nav-menu-widget-no-menus-message:first").hide(),0===(d=u.find(".widget-inside select:first")).find("option[value="+String(o)+"]").length&&d.append(new Option(r,o))),_.defer(function(){t.updateInvitationVisibility()})},_setupModel:function(){var t=this,n=t.params.menu_id;t.setting.bind(function(i){var o;!1===i?t._handleDeletion():(o=a(i.name),e.control.each(function(t){var i;t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base&&t.container.find("select").find("option[value="+String(n)+"]").text(o)}))})},_setupSortable:function(t){var n=this;if(!t.is(n.$sectionContent))throw new Error("Unexpected menuList.");t.on("sortstart",function(){n.isSorting=!0}),t.on("sortstop",function(){setTimeout(function(){var t=n.$sectionContent.sortable("toArray"),i=[],a=0,o=10;n.isSorting=!1,n.$sectionContent.scrollLeft(0),_.each(t,function(t){var n,a,o;(o=t.match(/^customize-control-nav_menu_item-(-?\d+)$/,""))&&(n=parseInt(o[1],10),(a=e.control("nav_menu_item["+String(n)+"]"))&&i.push(a))}),_.each(i,function(e){if(!1!==e.setting()){var t=_.clone(e.setting());a+=1,o+=1,t.position=a,e.priority(o),t.menu_item_parent=parseInt(e.container.find(".menu-item-data-parent-id").val(),10),t.menu_item_parent||(t.menu_item_parent=0),e.setting.set(t)}})})}),n.isReordering=!1,this.container.find(".reorder-toggle").on("click",function(){n.toggleReordering(!n.isReordering)})},_setupAddition:function(){var t=this;this.container.find(".add-new-menu-item").on("click",function(i){t.$sectionContent.hasClass("reordering")||(n("body").hasClass("adding-menu-items")?(n(this).attr("aria-expanded","false"),e.Menus.availableMenuItemsPanel.close(),i.stopPropagation()):(n(this).attr("aria-expanded","true"),e.Menus.availableMenuItemsPanel.open(t)))})},_handleDeletion:function(){var i=this,a,o=this.params.menu_id,s,r,u=0;a=e.section(this.section()),s=function(){a.container.remove(),e.section.remove(a.id)},a&&a.expanded()?a.collapse({completeCallback:function(){s(),t.a11y.speak(e.Menus.data.l10n.menuDeleted),e.panel("nav_menus").focus()}}):s(),e.each(function(e){/^nav_menu\[/.test(e.id)&&!1!==e()&&(u+=1)}),e.control.each(function(t){if(t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base){var n=t.container.find("select");n.val()===String(o)&&n.prop("selectedIndex",0).trigger("change"),t.container.find(".nav-menu-widget-form-controls:first").toggle(0!==u),t.container.find(".nav-menu-widget-no-menus-message:first").toggle(0===u),t.container.find("option[value="+String(o)+"]").remove()}}),(r=n("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )")).find(".nav-menu-widget-form-controls:first").toggle(0!==u),r.find(".nav-menu-widget-no-menus-message:first").toggle(0===u),r.find("option[value="+String(o)+"]").remove()},_setupTitle:function(){var t=this;t.setting.bind(function(i){if(i){var o=e.section(t.section()),s=t.params.menu_id,r=o.headContainer.find(".accordion-section-title"),u=o.contentContainer.find(".customize-section-title h3"),d=o.headContainer.find(".menu-in-location"),c=u.find(".customize-action"),l=a(i.name);r.text(l),d.length&&d.appendTo(r),u.text(l),c.length&&c.prependTo(u),e.control.each(function(e){/^nav_menu_locations\[/.test(e.id)&&e.container.find("option[value="+s+"]").text(l)}),o.contentContainer.find(".customize-control-checkbox input").each(function(){n(this).prop("checked")&&n(".current-menu-location-name-"+n(this).data("location-id")).text(l)})}})},toggleReordering:function(n){var i=this.container.find(".add-new-menu-item"),a=this.container.find(".reorder-toggle"),o=this.$sectionContent.find(".item-title");(n=Boolean(n))!==this.$sectionContent.hasClass("reordering")&&(this.isReordering=n,this.$sectionContent.toggleClass("reordering",n),this.$sectionContent.sortable(this.isReordering?"disable":"enable"),this.isReordering?(i.attr({tabindex:"-1","aria-hidden":"true"}),a.attr("aria-label",e.Menus.data.l10n.reorderLabelOff),t.a11y.speak(e.Menus.data.l10n.reorderModeOn),o.attr("aria-hidden","false")):(i.removeAttr("tabindex aria-hidden"),a.attr("aria-label",e.Menus.data.l10n.reorderLabelOn),t.a11y.speak(e.Menus.data.l10n.reorderModeOff),o.attr("aria-hidden","true")),n&&_(this.getMenuItemControls()).each(function(e){e.collapseForm()}))},getMenuItemControls:function(){var t=this,n=[],i=this.params.menu_id;return e.control.each(function(e){"nav_menu_item"===e.params.type&&e.setting()&&i===e.setting().nav_menu_term_id&&n.push(e)}),n},reflowMenuItems:function(){var e=this,t=this.getMenuItemControls(),n;(n=function(e){var t=[],i=e.currentParent;_.each(e.menuItemControls,function(e){i===e.setting().menu_item_parent&&t.push(e)}),t.sort(function(e,t){return e.setting().position-t.setting().position}),_.each(t,function(t){e.currentAbsolutePosition+=1,t.priority.set(e.currentAbsolutePosition),t.container.hasClass("menu-item-depth-"+String(e.currentDepth))||(_.each(t.container.prop("className").match(/menu-item-depth-\d+/g),function(e){t.container.removeClass(e)}),t.container.addClass("menu-item-depth-"+String(e.currentDepth))),t.container.data("item-depth",e.currentDepth),e.currentDepth+=1,e.currentParent=t.params.menu_item_id,n(e),e.currentDepth-=1,e.currentParent=i}),t.length&&(_(t).each(function(t){t.container.removeClass("move-up-disabled move-down-disabled move-left-disabled move-right-disabled"),0===e.currentDepth?t.container.addClass("move-left-disabled"):10===e.currentDepth&&t.container.addClass("move-right-disabled")}),t[0].container.addClass("move-up-disabled").addClass("move-right-disabled").toggleClass("move-down-disabled",1===t.length),t[t.length-1].container.addClass("move-down-disabled").toggleClass("move-up-disabled",1===t.length))})({menuItemControls:t,currentParent:0,currentDepth:0,currentAbsolutePosition:0}),this.updateInvitationVisibility(t),this.container.find(".reorder-toggle").toggle(t.length>1)},debouncedReflowMenuItems:_.debounce(function(){this.reflowMenuItems.apply(this,arguments)},0),addItemToMenu:function(i){var a=this,o,s,r,u,d,c=0,l=10;return _.each(this.getMenuItemControls(),function(e){!1!==e.setting()&&(l=Math.max(l,e.priority()),0===e.setting().menu_item_parent&&(c=Math.max(c,e.setting().position)))}),c+=1,l+=1,delete(i=n.extend({},e.Menus.data.defaultSettingValues.nav_menu_item,i,{nav_menu_term_id:this.params.menu_id,original_title:i.title,position:c})).id,d=e.Menus.generatePlaceholderAutoIncrementId(),o="nav_menu_item["+String(d)+"]",s={type:"nav_menu_item",transport:e.Menus.data.settingTransport,previewer:e.previewer},(r=e.create(o,o,{},s)).set(i),u=new e.controlConstructor.nav_menu_item(o,{type:"nav_menu_item",section:this.id,priority:l,settings:{default:o},menu_item_id:d}),e.control.add(u),r.preview(),this.debouncedReflowMenuItems(),t.a11y.speak(e.Menus.data.l10n.itemAdded),u},updateInvitationVisibility:function(e){var t=e||this.getMenuItemControls();this.container.find(".new-menu-item-invitation").toggle(0===t.length)}}),e.Menus.NewMenuControl=e.Control.extend({initialize:function(){"undefined"!=typeof console&&console.warn&&console.warn("[DEPRECATED] wp.customize.NewMenuControl will be removed. Please use wp.customize.Menus.createNavMenu() instead."),e.Control.prototype.initialize.apply(this,arguments)},ready:function(){this._bindHandlers()},_bindHandlers:function(){var e=this,t=n("#customize-control-new_menu_name input"),i=n("#create-new-menu-submit");t.on("keydown",function(t){13===t.which&&e.submit()}),i.on("click",function(t){e.submit(),t.stopPropagation(),t.preventDefault()})},submit:function(){var n=this,i,a=this.container.closest(".accordion-section-new-menu").find(".menu-name-field").first(),o=a.val(),s;if(!o)return a.addClass("invalid"),void a.focus();s=e.Menus.createNavMenu(o),a.val(""),a.removeClass("invalid"),t.a11y.speak(e.Menus.data.l10n.menuAdded),s.focus()}}),n.extend(e.controlConstructor,{nav_menu_location:e.Menus.MenuLocationControl,nav_menu_item:e.Menus.MenuItemControl,nav_menu:e.Menus.MenuControl,nav_menu_name:e.Menus.MenuNameControl,new_menu:e.Menus.NewMenuControl,nav_menu_locations:e.Menus.MenuLocationsControl,nav_menu_auto_add:e.Menus.MenuAutoAddControl}),n.extend(e.panelConstructor,{nav_menus:e.Menus.MenusPanel}),n.extend(e.sectionConstructor,{nav_menu:e.Menus.MenuSection,new_menu:e.Menus.NewMenuSection}),e.bind("ready",function(){e.Menus.availableMenuItemsPanel=new e.Menus.AvailableMenuItemsPanelView({collection:e.Menus.availableMenuItems}),e.bind("saved",function(t){(t.nav_menu_updates||t.nav_menu_item_updates)&&e.Menus.applySavedData(t)}),e.state("changesetStatus").bind(function(t){"publish"===t&&(e("nav_menus_created_posts")._value=[])}),e.previewer.bind("focus-nav-menu-item-control",e.Menus.focusMenuItemControl)}),e.Menus.applySavedData=function(i){var a={},o={};_(i.nav_menu_updates).each(function(i){var o,s,r,u,d,c,l,m,p,h,f,v,g;if("inserted"===i.status){if(!i.previous_term_id)throw new Error("Expected previous_term_id");if(!i.term_id)throw new Error("Expected term_id");if(o="nav_menu["+String(i.previous_term_id)+"]",!e.has(o))throw new Error("Expected setting to exist: "+o);if(u=e(o),!e.section.has(o))throw new Error("Expected control to exist: "+o);if(m=e.section(o),!(l=u.get()))throw new Error("Did not expect setting to be empty (deleted).");l=n.extend(_.clone(l),i.saved_value),a[i.previous_term_id]=i.term_id,s="nav_menu["+String(i.term_id)+"]",d=e.create(s,s,l,{type:"nav_menu",transport:e.Menus.data.settingTransport,previewer:e.previewer}),(g=m.expanded())&&m.collapse(),p=new e.Menus.MenuSection(s,{panel:"nav_menus",title:l.name,customizeAction:e.Menus.data.l10n.customizingMenus,type:"nav_menu",priority:m.priority.get(),menu_id:i.term_id}),e.section.add(p),e.control.each(function(t){var n,a,o;t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base&&(a=(n=t.container.find("select")).find("option[value="+String(i.previous_term_id)+"]"),(o=n.find("option[value="+String(i.term_id)+"]")).prop("selected",a.prop("selected")),a.remove())}),u.callbacks.disable(),u.set(!1),u.preview(),d.preview(),u._dirty=!1,m.container.remove(),e.section.remove(o),v=0,e.each(function(e){/^nav_menu\[/.test(e.id)&&!1!==e()&&(v+=1)}),(f=n("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )")).find(".nav-menu-widget-form-controls:first").toggle(0!==v),f.find(".nav-menu-widget-no-menus-message:first").toggle(0===v),f.find("option[value="+String(i.previous_term_id)+"]").remove(),t.customize.control.each(function(e){/^nav_menu_locations\[/.test(e.id)&&e.container.find("option[value="+String(i.previous_term_id)+"]").remove()}),e.each(function(t){var n=e.state("saved").get();/^nav_menu_locations\[/.test(t.id)&&t.get()===i.previous_term_id&&(t.set(i.term_id),t._dirty=!1,e.state("saved").set(n),t.preview())}),g&&p.expand()}else if("updated"===i.status){if(r="nav_menu["+String(i.term_id)+"]",!e.has(r))throw new Error("Expected setting to exist: "+r);c=e(r),_.isEqual(i.saved_value,c.get())||(h=e.state("saved").get(),c.set(i.saved_value),c._dirty=!1,e.state("saved").set(h))}}),_(i.nav_menu_item_updates).each(function(e){e.previous_post_id&&(o[e.previous_post_id]=e.post_id)}),_(i.nav_menu_item_updates).each(function(t){var n,i,s,r,u,d,c;if("inserted"===t.status){if(!t.previous_post_id)throw new Error("Expected previous_post_id");if(!t.post_id)throw new Error("Expected post_id");if(n="nav_menu_item["+String(t.previous_post_id)+"]",!e.has(n))throw new Error("Expected setting to exist: "+n);if(s=e(n),!e.control.has(n))throw new Error("Expected control to exist: "+n);if(d=e.control(n),!(u=s.get()))throw new Error("Did not expect setting to be empty (deleted).");if((u=_.clone(u)).menu_item_parent<0){if(!o[u.menu_item_parent])throw new Error("inserted ID for menu_item_parent not available");u.menu_item_parent=o[u.menu_item_parent]}a[u.nav_menu_term_id]&&(u.nav_menu_term_id=a[u.nav_menu_term_id]),i="nav_menu_item["+String(t.post_id)+"]",r=e.create(i,i,u,{type:"nav_menu_item",transport:e.Menus.data.settingTransport,previewer:e.previewer}),c=new e.controlConstructor.nav_menu_item(i,{type:"nav_menu_item",menu_id:t.post_id,section:"nav_menu["+String(u.nav_menu_term_id)+"]",priority:d.priority.get(),settings:{default:i},menu_item_id:t.post_id}),d.container.remove(),e.control.remove(n),e.control.add(c),s.callbacks.disable(),s.set(!1),s.preview(),r.preview(),s._dirty=!1,c.container.toggleClass("menu-item-edit-inactive",d.container.hasClass("menu-item-edit-inactive"))}}),_.each(i.widget_nav_menu_updates,function(t,n){var i=e(n);i&&(i._value=t,i.preview())})},e.Menus.focusMenuItemControl=function(t){var n=e.Menus.getMenuItemControl(t);n&&n.focus()},e.Menus.getMenuControl=function(t){return e.control("nav_menu["+t+"]")},e.Menus.getMenuItemControl=function(t){return e.control(i(t))}}(wp.customize,wp,jQuery);